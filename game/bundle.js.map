{"version":3,"sources":["webpack:///webpack/bootstrap b50d3f0ebe5b728858a4","webpack:///./src/modules/loader.js","webpack:///./src/modules/sprite.js","webpack:///./src/modules/character.js","webpack:///./src/modules/constants/states.js","webpack:///./src/modules/weapon.js","webpack:///./src/modules/constants/invertory.js","webpack:///./src/app.js","webpack:///./src/modules/game.js","webpack:///./src/modules/world.js","webpack:///./src/modules/keyboard.js","webpack:///./src/modules/camera.js","webpack:///./src/modules/player.js","webpack:///./src/modules/mouse.js","webpack:///./src/modules/enemy.js","webpack:///./src/modules/constants/keys.js","webpack:///./src/modules/constants/resources.js","webpack:///./src/modules/constants/characters.js","webpack:///./src/modules/constants/sprites.js"],"names":["images","sprites","sounds","successCallbacks","progressCallbacks","errorCallbacks","totalCount","loadedCount","_loadImage","src","cb","image","Image","onload","Object","keys","length","percentage","Math","floor","_loadSound","audioDecoder","request","XMLHttpRequest","open","responseType","decodeAudioData","response","buffer","error","send","loadResources","resources","forEach","renderResources","resource","push","onprogress","getSprite","name","getImage","getSound","Sprite","constructor","config","width","height","animationSpeed","imagePosition","framesCount","statesCount","frames","i","j","frame","document","createElement","getContext","drawImage","_index","update","delta","getFrame","state","getRandomFrame","random","index","Character","x","y","world","sprite","movementSpeed","health","STATES","idleForward","direction","isTileNotWalkable","tileSize","move","movedX","round","movedY","_isCollidedX","_isCollidedY","_updateState","_clampCoordinates","moveForward","moveBackward","idleBackward","maxX","columns","maxY","rows","max","min","attackForward","attackBackward","deathForward","deathBackward","Weapon","spriteForward","spriteBackward","fire","damage","capacity","bullets","reloadTime","speed","availableBullets","shot","lastShot","Date","now","isShoted","reload","isReloading","onReload","console","log","setTimeout","INVERTORY","pistol","shotgun","assaultRifle","window","canvas","getElementById","innerWidth","innerHeight","addEventListener","context","AudioContext","webkitAudioContext","audioContext","game","run","Game","loopedSounds","init","bulletHoles","blood","weapons","enemies","score","keyboard","mouse","player","CHARACTERS","camera","follow","enemyInterval","setInterval","isPaused","rat","weaponInterval","probability","dirx","diry","moved","isDown","KEYS","left","right","up","down","mousex","mousey","playLoopedSound","stopLoopedSound","weapon","invertory","currentItem","playSound","splice","indexOf","isEnemyHinted","isPlayerHinted","hitX","hitY","isClicked","isFlameAppeared","enemy","attackPlayer","award","SPRITES","bulletHole","pause","gameOver","render","startCol","endCol","startRow","endRow","offsetX","offsetY","column","row","map","isInBounds","hole","screenX","screenY","rect","strokeStyle","fillStyle","stroke","fillRect","font","textAlign","fillText","_previousElapsed","Loader","progress","style","display","appendChild","onclick","requestAnimationFrame","tick","bind","elapsed","clearRect","source","createBufferSource","connect","destination","start","volume","loop","gainNode","createGain","gain","value","stop","unpause","clearInterval","innerText","reset","World","getIndex","coordinate","Keyboard","keysPressed","key","onKeyDown","onKeyUp","event","keyCode","preventDefault","Camera","following","Player","default","defaultSprite","activeSprite","active","STATE","Mouse","clientX","clientY","Enemy","attackSpeed","sqrt","pow","abs","isAttacking","RESOURCES","pistolBackward","shotgunBackward","assaultRifleBackward"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 6);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap b50d3f0ebe5b728858a4","import { Sprite } from './sprite';\r\n\r\nconst images = {};\r\nconst sprites = {};\r\nconst sounds = {};\r\nconst successCallbacks = [], progressCallbacks = [], errorCallbacks = [];\r\nlet totalCount = 0, loadedCount;\r\n\r\nconst _loadImage = (src, cb) => {\r\n\tconst image = new Image();\r\n\timage.onload = () => {\r\n\t\timages[src] = image;\r\n\t\tloadedCount = Object.keys(images).length + Object.keys(sounds).length;\r\n\r\n\t\tfor (const cb of progressCallbacks) {\r\n\t\t\tcb({ percentage: Math.floor((loadedCount / totalCount) * 100) });\r\n\t\t}\r\n\t\tif (loadedCount === totalCount && typeof cb === 'function') {\r\n\t\t\tcb();\r\n\t\t}\r\n\t};\r\n\r\n\tfor (const cb of errorCallbacks) {\r\n\t\tcb('Couldn\\'t load image: ' + src);\r\n\t}\r\n\r\n\timage.src = src;\r\n};\r\n\r\nconst _loadSound = (src, audioDecoder, cb) => {\r\n\tconst request = new XMLHttpRequest();\r\n\trequest.open('GET', src, true);\r\n\trequest.responseType = 'arraybuffer';\r\n\r\n\t// Decode asynchronously\r\n\trequest.onload = function() {\r\n\t\taudioDecoder.decodeAudioData(request.response, (buffer) => {\r\n\t\t\tsounds[src] = buffer;\r\n\t\t\tloadedCount = Object.keys(images).length + Object.keys(sounds).length;\r\n\t\t\tfor (const cb of progressCallbacks) {\r\n\t\t\t\tcb({ percentage: Math.floor((loadedCount / totalCount) * 100) });\r\n\t\t\t}\r\n\t\t\tif (loadedCount === totalCount && typeof cb === 'function') {\r\n\t\t\t\tcb();\r\n\t\t\t}\r\n\t\t}, (error) => {\r\n\t\t\tfor (const cb of errorCallbacks) {\r\n\t\t\t\tcb('Couldn\\'t load sound: ' + src + '. ' + error);\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\trequest.send();\r\n};\r\n\r\nexport const loadResources = (resources, audioDecoder, sprites) => {\r\n\ttotalCount = resources.images.length + resources.sounds.length;\r\n\r\n\tresources.images.forEach(src => _loadImage(src, () => renderResources(sprites)));\r\n\tresources.sounds.forEach(src => _loadSound(src, audioDecoder, () => renderResources(sprites)));\r\n};\r\n\r\nexport const renderResources = (resources) => {\r\n\tfor (const resource in resources) {\r\n\t\tsprites[resource] = new Sprite(resources[resource]);\r\n\t}\r\n\r\n\tfor (const cb of successCallbacks) {\r\n\t\tcb();\r\n\t}\r\n};\r\n\r\nexport const onload = (cb) => successCallbacks.push(cb);\r\n\r\nexport const onprogress = (cb) => progressCallbacks.push(cb);\r\n\r\n\r\n\r\nexport const getSprite = (name) => sprites[name];\r\n\r\nexport const getImage = (src) => images[src];\r\n\r\nexport const getSound = (src) => sounds[src];\n\n\n// WEBPACK FOOTER //\n// ./src/modules/loader.js","import * as Loader from './loader';\r\n\r\nexport class Sprite {\r\n\tconstructor(config) {\r\n\t\tthis.image = Loader.getImage(config.src);\r\n\t\tthis.width = config.width;\r\n\t\tthis.height = config.height;\r\n\t\tthis.animationSpeed = config.animationSpeed;\r\n\t\tthis.imagePosition = config.imagePosition;\r\n\t\tthis.framesCount = Math.floor(this.image.width / this.width);\r\n\t\tthis.statesCount = !this.imagePosition ? Math.floor(this.image.height / this.height) : 1;\r\n\t\tthis.frames = [];\r\n\t\tfor (let i = 0; i < this.statesCount; i++) {\r\n\t\t\tthis.frames[i] = [];\r\n\t\t\tfor (let j = 0; j < this.framesCount; j++) {\r\n\t\t\t\tlet frame = document.createElement('canvas');\r\n\t\t\t\tframe.width = this.width;\r\n\t\t\t\tframe.height = this.height;\r\n\t\t\t\tframe.getContext('2d').drawImage(\r\n\t\t\t\t\tthis.image, // image\r\n\t\t\t\t\tj * this.width, // source x\r\n\t\t\t\t\tthis.imagePosition ? this.imagePosition: i * this.height, // source y\r\n\t\t\t\t\tthis.width, // source width\r\n\t\t\t\t\tthis.height, // source height\r\n\t\t\t\t\t0,  // target x\r\n\t\t\t\t\t0, // target y\r\n\t\t\t\t\tthis.width, // target width\r\n\t\t\t\t\tthis.height // target height\r\n\t\t\t\t);\r\n\t\t\t\tthis.frames[i][j] = frame\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis._index = 0;\r\n\t}\r\n\r\n\tupdate(delta) {\r\n\t\tif (this.animationSpeed) {\r\n\t\t\tthis._index += this.animationSpeed * delta;\r\n\t\t\tif (this._index > this.framesCount - 1) {\r\n\t\t\t\tthis._index = 0;\r\n\t\t\t}\r\n\t\t\tif (this._index < 0) {\r\n\t\t\t\tthis._index = this.framesCount - 1;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tgetFrame(frame, state) {\r\n\t\treturn this.frames[state ? state : 0][frame];\r\n\t}\r\n\r\n\tgetRandomFrame(state) {\r\n\t\treturn this.frames[state ? state : 0][Math.floor(Math.random() * this.framesCount)];\r\n\t}\r\n\r\n\tset index(index) {\r\n\t\tthis._index = index;\r\n\t}\r\n\r\n\tget index() {\r\n\t\treturn Math.floor(this._index);\r\n\t}\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/modules/sprite.js","import { Sprite } from './sprite';\r\nimport { STATES } from './constants/states';\r\n\r\nexport class Character {\r\n\tconstructor(x, y, world, config) {\r\n\t\tthis.sprite = new Sprite(config);\r\n\t\tthis.animationSpeed = config.movementSpeed;\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t\tthis.world = world;\r\n\t\tthis.health = config.health;\r\n\t\tthis.state = STATES.idleForward;\r\n\t\tthis.direction = 1;\r\n\r\n\t\twhile (this.world.isTileNotWalkable(this.x + this.sprite.width / 2, this.y + this.sprite.height)) {\r\n\t\t\tthis.x = this.x < this.world.width / 2 ? this.x + this.world.tileSize : this.x - this.world.tileSize;\r\n\t\t\tthis.y = this.x < this.world.height / 2 ? this.y + this.world.tileSize : this.y - this.world.tileSize;\r\n\t\t}\r\n\t}\r\n\r\n\tmove(delta, x, y) {\r\n\t\tlet movedX = Math.round(x * this.animationSpeed * delta), movedY = Math.round(y * this.animationSpeed * delta);\r\n\r\n\t\tif (this._isCollidedX(movedX)) {\r\n\t\t\tmovedX = 0;\r\n\t\t\tx = 0\r\n\t\t}\r\n\r\n\t\tif (this._isCollidedY(movedY)) {\r\n\t\t\tmovedY = 0;\r\n\t\t\ty = 0\r\n\t\t}\r\n\r\n\t\tthis._updateState(x, y);\r\n\r\n\t\tthis.x += movedX;\r\n\t\tthis.y += movedY;\r\n\r\n\t\t// clamp values\r\n\t\tthis._clampCoordinates();\r\n\r\n\t\treturn {\r\n\t\t\tx: movedX,\r\n\t\t\ty: movedY,\r\n\t\t}\r\n\t}\r\n\r\n\t_updateState(x, y) {\r\n\t\tif (x) {\r\n\t\t\tthis.direction = x;\r\n\t\t}\r\n\r\n\t\tif (x || y) {\r\n\t\t\tthis.state = this.direction === 1 ? STATES.moveForward : STATES.moveBackward;\r\n\t\t}\r\n\r\n\t\tif (!x && !y) {\r\n\t\t\tthis.state = this.direction === 1 ? STATES.idleForward : STATES.idleBackward;\r\n\t\t}\r\n\t}\r\n\r\n\t_isCollidedX(x) {\r\n\t\treturn this.x + x < 0 || (this.x + x + this.sprite.width) > this.world.width || this.world.isTileNotWalkable(this.x + x + this.sprite.width / 2, this.y + this.sprite.height);\r\n\t}\r\n\r\n\t_isCollidedY(y) {\r\n\t\treturn this.y + y < 0 || (this.y + y + this.sprite.height) > this.world.height || this.world.isTileNotWalkable(this.x + this.sprite.width / 2, this.y + y + this.sprite.height);\r\n\t}\r\n\r\n\t_clampCoordinates() {\r\n\t\tconst maxX = this.world.columns * this.world.tileSize;\r\n\t\tconst maxY = this.world.rows * this.world.tileSize;\r\n\t\tthis.x = Math.max(0, Math.min(this.x, maxX));\r\n\t\tthis.y = Math.max(0, Math.min(this.y, maxY));\r\n\t}\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/modules/character.js","export const STATES = {\r\n\tidleForward: 0,\r\n\tidleBackward: 1,\r\n\tmoveForward: 2,\r\n\tmoveBackward: 3,\r\n\tattackForward: 4,\r\n\tattackBackward: 5,\r\n\tdeathForward: 6,\r\n\tdeathBackward: 7\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/modules/constants/states.js","import * as Loader from './loader';\r\n\r\nexport class Weapon {\r\n\tconstructor(spriteForward, spriteBackward, config) {\r\n\t\tthis.spriteForward = spriteForward;\r\n\t\tthis.spriteBackward = spriteBackward;\r\n\t\tthis.sprite = this.spriteForward;\r\n\t\tthis.name = config.name;\r\n\t\tthis.fire = Loader.getSprite('fire');\r\n\t\tthis.damage = config.damage;\r\n\t\tthis.capacity = config.capacity;\r\n\t\tthis.bullets = config.bullets;\r\n\t\tthis.reloadTime = config.reloadTime;\r\n\t\tthis.speed = config.speed;\r\n\t\tthis.availableBullets = config.capacity;\r\n\t}\r\n\r\n\tshot() {\r\n\t\tif (this.availableBullets) {\r\n\t\t\tif (this.speed) {\r\n\t\t\t\tif (!this.lastShot || Date.now() - this.lastShot > this.speed) {\r\n\t\t\t\t\tthis.lastShot = Date.now();\r\n\t\t\t\t\tthis.availableBullets--;\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t} else if (!this.isShoted) {\r\n\t\t\t\tthis.isShoted = true;\r\n\t\t\t\tthis.availableBullets--;\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.reload();\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\treload() {\r\n\t\tif (this.bullets && this.availableBullets < this.capacity && !this.isReloading) {\r\n\t\t\tif (this.onReload) {\r\n\t\t\t\tthis.onReload();\r\n\t\t\t}\r\n\r\n\t\t\tconsole.log('reloading...');\r\n\t\t\tthis.isReloading = true;\r\n\t\t\tthis.bullets += this.availableBullets;\r\n\t\t\tthis.availableBullets = 0;\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tthis.availableBullets = this.bullets >= this.capacity ? this.capacity : this.bullets % this.capacity;\r\n\t\t\t\tthis.bullets = this.bullets >= this.capacity ? this.bullets - this.capacity : 0;\r\n\t\t\t\tthis.isReloading = false;\r\n\t\t\t}, this.reloadTime)\r\n\t\t}\r\n\t}\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/modules/weapon.js","export const INVERTORY = {\r\n\tpistol: {\r\n\t\tname: 'pistol',\r\n\t\tdamage: 9,\r\n\t\tcapacity: 7,\r\n\t\tbullets: 35,\r\n\t\treloadTime: 1500,\r\n\t\tspeed: 0\r\n\t},\r\n\tshotgun: {\r\n\t\tname: 'shotgun',\r\n\t\tdamage: 50,\r\n\t\tcapacity: 2,\r\n\t\tbullets: 20,\r\n\t\treloadTime: 2500,\r\n\t\tspeed: 0\r\n\t},\r\n\tassaultRifle: {\r\n\t\tname: 'assaultRifle',\r\n\t\tdamage: 20,\r\n\t\tcapacity: 30,\r\n\t\tbullets: 120,\r\n\t\treloadTime: 2500,\r\n\t\tspeed: 125\r\n\t}\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/modules/constants/invertory.js","import { Game } from './modules/game';\r\n\r\nwindow.onload = () => {\r\n\tconst canvas = document.getElementById('game');\r\n\tcanvas.width = window.innerWidth;\r\n\tcanvas.height = window.innerHeight;\r\n\twindow.addEventListener('resize', () => {\r\n\t\tcanvas.width = window.innerWidth;\r\n\t\tcanvas.height = window.innerHeight;\r\n\t});\r\n\tconst context = canvas.getContext('2d');\r\n\r\n\twindow.AudioContext = window.AudioContext || window.webkitAudioContext;\r\n\tconst audioContext = new AudioContext();\r\n\r\n\tconst game = new Game(context, audioContext);\r\n\tgame.run();\r\n};\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/app.js","import * as Loader from './loader';\r\nimport { World } from './world';\r\nimport { Keyboard } from './keyboard';\r\nimport { Camera } from './camera';\r\nimport { Player } from './player';\r\nimport { Mouse } from './mouse';\r\nimport { Sprite } from './sprite';\r\nimport { Enemy } from './enemy';\r\nimport { KEYS } from './constants/keys';\r\nimport { INVERTORY } from './constants/invertory';\r\nimport { Weapon } from './weapon';\r\nimport { RESOURCES } from './constants/resources';\r\nimport { CHARACTERS } from './constants/characters';\r\nimport { SPRITES } from './constants/sprites';\r\n\r\nexport class Game {\r\n\tconstructor(context, audioContext) {\r\n\t\tthis.context = context;\r\n\t\tthis.audioContext = audioContext;\r\n\t\tthis.loopedSounds = {};\r\n\t\tthis.framesCount = 0;\r\n\t}\r\n\r\n\tinit() {\r\n\t\tthis.bulletHoles = [];\r\n\t\tthis.blood = [];\r\n\t\tthis.weapons = [];\r\n\t\tthis.enemies = [];\r\n\t\tthis.score = 0;\r\n\t\tthis.world = new World(30, 30, Loader.getSprite('map'));\r\n\t\tthis.keyboard = new Keyboard(KEYS);\r\n\t\tthis.mouse = new Mouse();\r\n\t\tthis.player = new Player(this.world, CHARACTERS.player);\r\n\t\tthis.camera = new Camera(this.world);\r\n\t\tthis.camera.follow(this.player);\r\n\r\n\t\tthis.enemyInterval = setInterval(() => {\r\n\t\t\tif (!this.isPaused)  {\r\n\t\t\t\tthis.enemies.push(new Enemy(this.world, this.player, CHARACTERS.rat));\r\n\t\t\t\tconsole.log('Generated enemy');\r\n\t\t\t}\r\n\t\t}, 3000);\r\n\t\tthis.weaponInterval = setInterval(() => {\r\n\t\t\tif (!this.isPaused) {\r\n\t\t\t\tconst probability = Math.random();\r\n\t\t\t\tif (this.score >= 3000 && probability < 0.5) {\r\n\t\t\t\t\tthis.weapons.push(new Weapon(Loader.getSprite('assaultRifle'), Loader.getSprite('assaultRifleBackward'), INVERTORY.assaultRifle));\r\n\t\t\t\t} else if (this.score >= 1000 && probability < 0.5) {\r\n\t\t\t\t\tthis.weapons.push(new Weapon(Loader.getSprite('shotgun'), Loader.getSprite('shotgunBackward'), INVERTORY.shotgun));\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.weapons.push(new Weapon(Loader.getSprite('pistol'), Loader.getSprite('pistolBackward'), INVERTORY.pistol));\r\n\t\t\t\t}\r\n\t\t\t\tthis.weapons[this.weapons.length - 1].x = Math.floor(Math.random() * this.world.width);\r\n\t\t\t\tthis.weapons[this.weapons.length - 1].y = Math.floor(Math.random() * this.world.height);\r\n\r\n\t\t\t\tconsole.log('Generated weapon');\r\n\t\t\t}\r\n\t\t}, 10000);\r\n\t}\r\n\r\n\tupdate(delta) {\r\n\t\tlet dirx = 0, diry = 0, moved;\r\n\r\n\t\tif (this.keyboard.isDown(KEYS.left)) { dirx = -1; }\r\n\t\telse if (this.keyboard.isDown(KEYS.right)) { dirx = 1; }\r\n\r\n\t\tif (this.keyboard.isDown(KEYS.up)) { diry = -1; }\r\n\t\telse if (this.keyboard.isDown(KEYS.down)) { diry = 1; }\r\n\r\n\t\tthis.player.mousex = this.mouse.x;\r\n\t\tthis.player.mousey = this.mouse.y;\r\n\r\n\t\tthis.player.sprite.update(delta);\r\n\t\tmoved = this.player.move(delta, dirx, diry);\r\n\r\n\t\tif ((dirx || diry) && !this.loopedSounds['trot'] && (moved.x || moved.y)) {\r\n\t\t\tthis.playLoopedSound(Loader.getSound('sound/trot.mp3'), 'trot');\r\n\t\t} else if (((!dirx && !diry) || (!moved.x && !moved.y)) && this.loopedSounds['trot']) {\r\n\t\t\tthis.stopLoopedSound('trot');\r\n\t\t}\r\n\r\n\t\tfor (let weapon of this.weapons) {\r\n\t\t\tif (weapon.x >= this.player.x &&\r\n\t\t\t\tweapon.x <= this.player.x + this.player.sprite.width &&\r\n\t\t\t\tweapon.y >= this.player.y &&\r\n\t\t\t\tweapon.y <= this.player.y + this.player.sprite.height) {\r\n\t\t\t\tif (this.player.invertory[weapon.name]) {\r\n\t\t\t\t\tthis.player.invertory[weapon.name].bullets += weapon.bullets;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.player.invertory[weapon.name] = weapon;\r\n\t\t\t\t\tthis.player.currentItem = weapon;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.playSound(Loader.getSound('sound/pickup.mp3'));\r\n\r\n\t\t\t\tthis.weapons.splice(this.weapons.indexOf(weapon), 1);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.keyboard.isDown(KEYS.pistol) && this.player.invertory.pistol && this.player.invertory.pistol.bullets && (!this.player.currentItem || this.player.currentItem.name !== 'pistol')) {\r\n\t\t\tthis.player.currentItem = this.player.invertory.pistol;\r\n\t\t\tthis.playSound(Loader.getSound('sound/pickup.mp3'));\r\n\t\t}\r\n\r\n\t\tif (this.keyboard.isDown(KEYS.shotgun) && this.player.invertory.shotgun && this.player.invertory.shotgun.bullets && (!this.player.currentItem || this.player.currentItem.name !== 'shotgun')) {\r\n\t\t\tthis.player.currentItem = this.player.invertory.shotgun;\r\n\t\t\tthis.playSound(Loader.getSound('sound/pickup.mp3'));\r\n\t\t}\r\n\r\n\t\tif (this.keyboard.isDown(KEYS.assaultRifle) && this.player.invertory.assaultRifle && this.player.invertory.assaultRifle.bullets && (!this.player.currentItem || this.player.currentItem.name !== 'assaultRifle')) {\r\n\t\t\tthis.player.currentItem = this.player.invertory.assaultRifle;\r\n\t\t\tthis.playSound(Loader.getSound('sound/pickup.mp3'));\r\n\t\t}\r\n\r\n\t\tlet isEnemyHinted = false, isPlayerHinted, hitX, hitY;\r\n\r\n\t\tif (this.player.currentItem) {\r\n\t\t\tif (!this.player.currentItem.onReload) {\r\n\t\t\t\tthis.player.currentItem.onReload = () => this.playSound(Loader.getSound('sound/' + this.player.currentItem.name + 'Reload.mp3'))\r\n\t\t\t}\r\n\t\t\tif (!this.player.currentItem.availableBullets && !this.player.currentItem.bullets) {\r\n\t\t\t\tthis.player.invertory[this.player.currentItem.name] = null;\r\n\t\t\t\tthis.player.currentItem = null;\r\n\t\t\t} else {\r\n\t\t\t\tif (this.keyboard.isDown(KEYS.reload)) {\r\n\t\t\t\t\tthis.player.currentItem.reload();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (this.mouse.isClicked && !this.player.currentItem.isShoted && !this.player.currentItem.isReloading) {\r\n\t\t\t\t\tif (this.player.currentItem.shot()) {\r\n\t\t\t\t\t\thitX = this.camera.x + this.mouse.x;\r\n\t\t\t\t\t\thitY = this.camera.y + this.mouse.y;\r\n\t\t\t\t\t\tconsole.log(this.player.currentItem.availableBullets  + ' / '  + this.player.currentItem.bullets);\r\n\t\t\t\t\t\tthis.isFlameAppeared = true;\r\n\t\t\t\t\t\tsetTimeout(() => this.isFlameAppeared = false, 50);\r\n\t\t\t\t\t\tthis.playSound(Loader.getSound('sound/' + this.player.currentItem.name + '.mp3'));\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (!this.mouse.isClicked) { // We also have non-automatic weapons (pistol, shotgun)\r\n\t\t\t\t\tthis.player.currentItem.isShoted = false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Update enemies state\r\n\t\tfor (let enemy of this.enemies) {\r\n\t\t\tenemy.sprite.update(delta);\r\n\r\n\t\t\tif (enemy.attackPlayer(delta) && !isPlayerHinted) {\r\n\t\t\t\tthis.playSound(Loader.getSound('sound/' + enemy.name + 'Attack.mp3'));\r\n\t\t\t\tisPlayerHinted = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (hitX && hitY) {\r\n\t\t\t\tif (hitX >= enemy.x && hitX <= enemy.x + enemy.sprite.width &&\r\n\t\t\t\t\thitY >= enemy.y && hitY <= enemy.y + enemy.sprite.height) {\r\n\t\t\t\t\tenemy.health -= this.player.currentItem.damage;\r\n\t\t\t\t\tisEnemyHinted = true;\r\n\r\n\t\t\t\t\tconsole.log('Enemy health - ' + enemy.health);\r\n\t\t\t\t\tif (enemy.health <= 0) {\r\n\t\t\t\t\t\tthis.playSound(Loader.getSound('sound/' + enemy.name + 'Death.mp3'));\r\n\t\t\t\t\t\tthis.enemies.splice(this.enemies.indexOf(enemy), 1);\r\n\t\t\t\t\t\tthis.score += enemy.award;\r\n\t\t\t\t\t\tconsole.log('Score - ' + this.score);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (isPlayerHinted) {\r\n\t\t\tlet blood = new Sprite(SPRITES.blood);\r\n\t\t\tblood.index = Math.random() * blood.framesCount;\r\n\t\t\tthis.blood.push({\r\n\t\t\t\tx: this.player.x + this.player.sprite.width / 2,\r\n\t\t\t\ty: this.player.y + this.player.sprite.height / 2,\r\n\t\t\t\tsprite: blood\r\n\t\t\t});\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tthis.blood.splice(this.blood.indexOf(blood), 1);\r\n\t\t\t}, 10000)\r\n\t\t}\r\n\r\n\t\tif (hitX && hitY) {\r\n\t\t\tif (isEnemyHinted) {\r\n\t\t\t\tlet blood = new Sprite(SPRITES.blood);\r\n\t\t\t\tblood.index = Math.random() * blood.framesCount;\r\n\t\t\t\tthis.blood.push({\r\n\t\t\t\t\tx: hitX,\r\n\t\t\t\t\ty: hitY,\r\n\t\t\t\t\tsprite: blood\r\n\t\t\t\t});\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tthis.blood.splice(this.blood.indexOf(blood), 1);\r\n\t\t\t\t}, 10000)\r\n\t\t\t} else {\r\n\t\t\t\tlet bulletHole = {\r\n\t\t\t\t\tx: hitX,\r\n\t\t\t\t\ty: hitY,\r\n\t\t\t\t\tsprite: Loader.getSprite('hole')\r\n\t\t\t\t};\r\n\t\t\t\tthis.bulletHoles.push(bulletHole);\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tthis.bulletHoles.splice(this.bulletHoles.indexOf(bulletHole), 1);\r\n\t\t\t\t}, 10000)\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.camera.update();\r\n\r\n\t\tif (this.keyboard.isDown(KEYS.pause)) {\r\n\t\t\tthis.pause();\r\n\t\t}\r\n\r\n\t\tif (this.player.health <= 0) {\r\n\t\t\treturn this.gameOver();\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\t// Render map\r\n\t\tconst startCol = Math.floor(this.camera.x / this.world.tileSize);\r\n\t\tconst endCol = startCol + (this.camera.width / this.world.tileSize);\r\n\t\tconst startRow = Math.floor(this.camera.y / this.world.tileSize);\r\n\t\tconst endRow = startRow + (this.camera.height / this.world.tileSize);\r\n\t\tconst offsetX = -this.camera.x + startCol * this.world.tileSize;\r\n\t\tconst offsetY = -this.camera.y + startRow * this.world.tileSize;\r\n\r\n\t\tfor (let column = startCol; column <= endCol + 1; column++) {\r\n\t\t\tfor (let row = startRow; row <= endRow + 1; row++) {\r\n\t\t\t\tif (this.world.map[row] && typeof this.world.map[row][column] !== 'undefined') {\r\n\t\t\t\t\tlet x = Math.floor((column - startCol) * this.world.tileSize + offsetX);\r\n\t\t\t\t\tlet y = Math.floor((row - startRow) * this.world.tileSize + offsetY);\r\n\t\t\t\t\tthis.context.drawImage(\r\n\t\t\t\t\t\tthis.world.sprite.getFrame(this.world.map[row][column]),\r\n\t\t\t\t\t\tx,\r\n\t\t\t\t\t\ty\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Render blood\r\n\t\tfor (const blood of this.blood) {\r\n\t\t\tif (this.camera.isInBounds(blood.x, blood.y)) {\r\n\t\t\t\tthis.context.drawImage(\r\n\t\t\t\t\tblood.sprite.getFrame(blood.sprite.index),\r\n\t\t\t\t\tMath.floor(blood.x - this.camera.x - blood.sprite.width / 2),\r\n\t\t\t\t\tMath.floor(blood.y - this.camera.y - blood.sprite.height / 2),\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Render bullet holes\r\n\t\tfor (const hole of this.bulletHoles) {\r\n\t\t\tif (this.camera.isInBounds(hole.x, hole.y)) {\r\n\t\t\t\tthis.context.drawImage(\r\n\t\t\t\t\thole.sprite.getFrame(0),\r\n\t\t\t\t\tMath.floor(hole.x - this.camera.x - hole.sprite.width / 2),\r\n\t\t\t\t\tMath.floor(hole.y - this.camera.y - hole.sprite.height / 2)\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Render weapons\r\n\t\tfor (const weapon of this.weapons) {\r\n\t\t\tif (this.camera.isInBounds(weapon.x, weapon.y)) {\r\n\t\t\t\tthis.context.drawImage(\r\n\t\t\t\t\tweapon.sprite.getFrame(0),\r\n\t\t\t\t\tMath.floor(weapon.x - this.camera.x - weapon.sprite.width / 2),\r\n\t\t\t\t\tMath.floor(weapon.y - this.camera.y - weapon.sprite.height / 2),\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Render player\r\n\t\tthis.context.drawImage(\r\n\t\t\tthis.player.sprite.getFrame(this.player.sprite.index, this.player.state),\r\n\t\t\tthis.player.screenX,\r\n\t\t\tthis.player.screenY\r\n\t\t);\r\n\r\n\t\t// Render enemies\r\n\t\tfor (let enemy of this.enemies) {\r\n\t\t\tif (this.camera.isInBounds(enemy.x, enemy.y) || this.camera.isInBounds(enemy.x + enemy.sprite.width, enemy.y + enemy.sprite.height)) {\r\n\t\t\t\tthis.context.drawImage(\r\n\t\t\t\t\tenemy.sprite.getFrame(enemy.sprite.index, enemy.state),\r\n\t\t\t\t\tenemy.x - this.camera.x,\r\n\t\t\t\t\tenemy.y - this.camera.y,\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Render player's weapon\r\n\t\tif (this.player.currentItem && !this.player.currentItem.isReloading) {\r\n\t\t\tthis.context.drawImage(\r\n\t\t\t\tthis.player.currentItem.sprite.getFrame(0),\r\n\t\t\t\tthis.player.direction > 0 ? this.player.screenX + this.player.sprite.width : this.player.screenX - this.player.currentItem.sprite.width,\r\n\t\t\t\tthis.player.screenY + 35,\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\t// Render weapon fire\r\n\t\tif (this.player.currentItem && this.isFlameAppeared) {\r\n\t\t\tthis.context.drawImage(\r\n\t\t\t\tthis.player.currentItem.fire.getFrame(0, this.player.direction > 0 ? 0: 1),\r\n\t\t\t\tthis.player.direction > 0 ?\r\n\t\t\t\t\tthis.player.screenX + this.player.sprite.width + this.player.currentItem.sprite.width :\r\n\t\t\t\t\tthis.player.screenX - this.player.currentItem.sprite.width - 50,\r\n\t\t\t\tthis.player.screenY + 23,\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\t// Render HUD\r\n\t\tthis.context.rect(70, window.innerHeight - 100, 400, 25);\r\n\r\n\t\t// Health bar\r\n\t\tthis.context.strokeStyle = '#14ff17';\r\n\t\tthis.context.fillStyle = '#14ff17';\r\n\t\tthis.context.stroke();\r\n\t\tthis.context.fillRect(70, window.innerHeight - 100, 400 * (this.player.health / 100), 25);\r\n\r\n\t\t// Text style\r\n\t\tthis.context.font='36px Overseer';\r\n\t\tthis.context.textAlign='center';\r\n\r\n\t\t// Score\r\n\t\tthis.context.fillText('Score: ' + this.score, Math.floor(window.innerWidth / 2), window.innerHeight - 75);\r\n\r\n\t\t// Weapon\r\n\t\tif (this.player.currentItem) {\r\n\t\t\tthis.context.fillText(this.player.currentItem.availableBullets + ' / ' + this.player.currentItem.bullets, window.innerWidth - 100, window.innerHeight - 75);\r\n\t\t}\r\n\t}\r\n\r\n\trun() {\r\n\t\tthis._previousElapsed = 0;\r\n\t\tLoader.onprogress(progress => {\r\n\t\t\tconsole.log(progress.percentage);\r\n\t\t\tdocument.getElementById('loadingBar').style.width = progress.percentage + '%';\r\n\t\t});\r\n\t\tLoader.onload(() => {\r\n\t\t\tthis.playLoopedSound(Loader.getSound('sound/background.mp3'), 'background', 0.2);\r\n\t\t\tdocument.getElementById('loading').style.display = 'none';\r\n\t\t\tdocument.getElementById('menu').style.display = 'block';\r\n\r\n\t\t\tdocument.getElementById('mainImage').appendChild(Loader.getImage('img/main.png'));\r\n\r\n\t\t\tdocument.getElementById('start').onclick = () => {\r\n\t\t\t\tdocument.getElementById('main').style.display = 'none';\r\n\t\t\t\tthis.init();\r\n\t\t\t\twindow.requestAnimationFrame(this.tick.bind(this));\r\n\t\t\t}\r\n\t\t});\r\n\t\tLoader.loadResources(RESOURCES, this.audioContext, SPRITES);\r\n\t}\r\n\r\n\ttick(elapsed) {\r\n\t\tif (!this.isPaused) {\r\n\t\t\twindow.requestAnimationFrame(this.tick.bind(this));\r\n\r\n\t\t\t// clear previous frame\r\n\t\t\tthis.context.clearRect(0, 0, window.innerWidth, window.innerHeight);\r\n\r\n\t\t\t// compute delta time in seconds -- also cap it\r\n\t\t\telapsed = Math.floor(elapsed);\r\n\t\t\tlet delta = (elapsed - this._previousElapsed) / 1000.0;\r\n\t\t\tdelta = Math.min(delta, 0.25); // maximum delta of 250 ms\r\n\t\t\tthis._previousElapsed = elapsed;\r\n\r\n\t\t\tthis.update(delta);\r\n\t\t\tthis.render();\r\n\t\t}\r\n\t}\r\n\r\n\tplaySound(buffer) {\r\n\t\tconst source = this.audioContext.createBufferSource(); // creates a sound source\r\n\t\tsource.buffer = buffer; // tell the source which sound to play\r\n\t\tsource.connect(this.audioContext.destination); // connect the source to the context's destination (the speakers)\r\n\t\tsource.start(0);\r\n\t}\r\n\r\n\tplayLoopedSound(buffer, name, volume = 1) {\r\n\t\tconst source = this.audioContext.createBufferSource(); // creates a sound source\r\n\t\tsource.buffer = buffer; // tell the source which sound to play\r\n\t\tsource.loop = true;\r\n\t\tconst gainNode = this.audioContext.createGain(); // Connect the source to the gain node.\r\n\t\tsource.connect(gainNode); // Connect the gain node to the destination.\r\n\t\tgainNode.connect(this.audioContext.destination);\r\n\t\tgainNode.gain.value = volume;\r\n\r\n\t\tthis.loopedSounds[name] = source;\r\n\r\n\t\tsource.start(0);\r\n\t}\r\n\r\n\tstopLoopedSound(name) {\r\n\t\tthis.loopedSounds[name].stop();\r\n\t\tthis.loopedSounds[name] = null;\r\n\t}\r\n\r\n\tpause() {\r\n\t\tthis.isPaused = true;\r\n\r\n\t\tif (this.loopedSounds['trot']) {\r\n\t\t\tthis.loopedSounds['trot'].stop();\r\n\t\t\tthis.loopedSounds['trot'] = null;\r\n\t\t}\r\n\r\n\t\tdocument.getElementById('pause').style.display = 'block';\r\n\t\tdocument.getElementById('pauseImage').appendChild(Loader.getImage('img/pause.png'));\r\n\t\tdocument.getElementById('resume').onclick = this.unpause.bind(this);\r\n\t}\r\n\r\n\tunpause() {\r\n\t\tdocument.getElementById('pause').style.display = 'none';\r\n\t\tthis.isPaused = false;\r\n\t\twindow.requestAnimationFrame(this.tick.bind(this));\r\n\t}\r\n\r\n\tgameOver() {\r\n\t\tconsole.log('Game over');\r\n\t\tthis.isPaused = true;\r\n\t\tclearInterval(this.enemyInterval);\r\n\t\tclearInterval(this.weaponInterval);\r\n\r\n\t\tif (this.loopedSounds['trot']) {\r\n\t\t\tthis.loopedSounds['trot'].stop();\r\n\t\t\tthis.loopedSounds['trot'] = null;\r\n\t\t}\r\n\r\n\t\tdocument.getElementById('gameOver').style.display = 'block';\r\n\t\tdocument.getElementById('gameOverImage').appendChild(Loader.getImage('img/gameOver.png'));\r\n\t\tdocument.getElementById('score').innerText= this.score;\r\n\t\tdocument.getElementById('tryAgain').onclick = this.reset.bind(this);\r\n\t}\r\n\r\n\treset() {\r\n\t\tdocument.getElementById('gameOver').style.display = 'none';\r\n\r\n\t\tthis.init();\r\n\t\tthis.isPaused = false;\r\n\t\twindow.requestAnimationFrame(this.tick.bind(this));\r\n\t}\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/modules/game.js","export class World {\r\n\tconstructor(rows, columns, map) {\r\n\t\tthis.rows = rows;\r\n\t\tthis.columns = columns;\r\n\t\tthis.tileSize = map.width;\r\n\t\tthis.width = columns * this.tileSize;\r\n\t\tthis.height = rows * this.tileSize;\r\n\t\tthis.sprite = map;\r\n\r\n\t\tthis.map = [];\r\n\t\tfor (let row = 0; row < rows; row++) {\r\n\t\t\tthis.map[row] = [];\r\n\t\t\tfor (let column = 0; column < columns; column++) {\r\n\t\t\t\tif (Math.random() < 0.1) {\r\n\t\t\t\t\tthis.map[row][column] = Math.floor(Math.random() * 5)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.map[row][column] = 0\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tgetIndex(coordinate) {\r\n\t\treturn Math.floor(coordinate / this.tileSize);\r\n\t}\r\n\r\n\tisTileNotWalkable(x, y) {\r\n\t\tconst row = this.getIndex(y);\r\n\t\tconst column = this.getIndex(x);\r\n\r\n\t\treturn this.map[row] && this.map[row][column] > 0;\r\n\t}\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/modules/world.js","export class Keyboard {\r\n\tconstructor(keys) {\r\n\t\tthis.keysPressed = {};\r\n\t\t// keys.forEach((key) => {\r\n\t\t// \tthis.keysPressed[key] = false;\r\n\t\t// });\r\n\t\t// for (const key in keys) {\r\n\t\t// \tthis.keysPressed[keys[key]] = false;\r\n\t\t// }\r\n\r\n\t\tfor (const key of Object.keys(keys)) {\r\n\t\t\tthis.keysPressed[keys[key]] = false;\r\n\t\t}\r\n\r\n\t\twindow.addEventListener('keydown', this.onKeyDown.bind(this));\r\n\t\twindow.addEventListener('keyup', this.onKeyUp.bind(this));\r\n\t\twindow.addEventListener('blur', () => {\r\n\t\t\tfor (const key of Object.keys(keys)) {\r\n\t\t\t\tthis.keysPressed[keys[key]] = false;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tonKeyDown(event) {\r\n\t\tconst keyCode = event.keyCode;\r\n\t\tif (keyCode in this.keysPressed) {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tthis.keysPressed[keyCode] = true;\r\n\t\t}\r\n\t}\r\n\r\n\tonKeyUp(event) {\r\n\t\tconst keyCode = event.keyCode;\r\n\t\tif (keyCode in this.keysPressed) {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tthis.keysPressed[keyCode] = false;\r\n\t\t}\r\n\t}\r\n\r\n\tisDown(keyCode) {\r\n\t\treturn this.keysPressed[keyCode];\r\n\t};\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/modules/keyboard.js","export class Camera {\r\n\tconstructor(map) {\r\n\t\tthis.width = window.innerWidth;\r\n\t\tthis.height = window.innerHeight;\r\n\t\tthis.maxX = map.columns * map.tileSize - this.width;\r\n\t\tthis.maxY = map.rows * map.tileSize - this.height;\r\n\t\tthis.x = this.width / 2;\r\n\t\tthis.y = this.height / 2;\r\n\r\n\t\twindow.addEventListener('resize', () => {\r\n\t\t\tthis.width = window.innerWidth;\r\n\t\t\tthis.height = window.innerHeight;\r\n\t\t\tthis.maxX = map.columns * map.tileSize - this.width;\r\n\t\t\tthis.maxY = map.rows * map.tileSize - this.height;\r\n\t\t});\r\n\t}\r\n\r\n\tfollow(player) {\r\n\t\tthis.following = player;\r\n\t}\r\n\r\n\tupdate() {\r\n\t\t// assume followed sprite should be placed at the center of the screen\r\n\t\t// whenever possible\r\n\t\tthis.following.screenX = Math.floor ((this.width / 2) - (this.following.sprite.width / 2));\r\n\t\tthis.following.screenY = Math.floor ((this.height / 2) - (this.following.sprite.height / 2));\r\n\r\n\t\t// make the camera follow the sprite\r\n\t\tthis.x = Math.floor(this.following.x - this.following.screenX);\r\n\t\tthis.y = Math.floor(this.following.y - this.following.screenY);\r\n\t\t// clamp values\r\n\t\tthis.x = Math.max(0, Math.min(this.x, this.maxX));\r\n\t\tthis.y = Math.max(0, Math.min(this.y, this.maxY));\r\n\r\n\t\t// in map corners, the sprite cannot be placed in the center of the screen\r\n\t\t// and we have to change its screen coordinates\r\n\r\n\t\t// left and right sides\r\n\t\tif (this.following.x < this.following.screenX ||\r\n\t\t\tthis.following.x > this.maxX + this.following.screenX) {\r\n\t\t\tthis.following.screenX = this.following.x - this.x;\r\n\t\t}\r\n\t\t// top and bottom sides\r\n\t\tif (this.following.y < this.following.screenY ||\r\n\t\t\tthis.following.y > this.maxY + this.following.screenY) {\r\n\t\t\tthis.following.screenY = this.following.y - this.y;\r\n\t\t}\r\n\t}\r\n\r\n\tisInBounds(x, y) {\r\n\t\treturn (x >= this.x && y >= this.y) && (x <= this.x + this.width && y <= this.y + this.height);\r\n\t}\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/modules/camera.js","import { Character } from './character';\r\nimport { Sprite } from './sprite';\r\nimport { STATES as STATE } from './constants/states';\r\nimport { Weapon } from './weapon';\r\nimport { INVERTORY } from './constants/invertory';\r\nimport * as Loader from './loader';\r\n\r\nexport class Player extends Character {\r\n\tconstructor(world, config) {\r\n\t\tsuper(world.width / 2, world.height / 2, world, config.default);\r\n\t\tthis.defaultSprite = this.sprite;\r\n\t\tthis.activeSprite = new Sprite(config.active); // lightning unicorn\r\n\t\tthis.screenX = this.x;\r\n\t\tthis.screenY = this.y;\r\n\r\n\t\tthis.invertory = {\r\n\t\t\tpistol: new Weapon(Loader.getSprite('pistol'), Loader.getSprite('pistolBackward'), INVERTORY.pistol)\r\n\t\t};\r\n\t\tthis.currentItem = this.invertory.pistol;\r\n\t}\r\n\r\n\t_updateState(x, y) {\r\n\t\tthis.sprite = this.currentItem ? this.activeSprite : this.defaultSprite;\r\n\t\tthis.direction = this.mousex > this.screenX + (this.sprite.width / 2) ? 1 : -1;\r\n\r\n\t\tif (this.currentItem) {\r\n\t\t\tthis.currentItem.sprite = this.direction > 0 ? this.currentItem.spriteForward : this.currentItem.spriteBackward;\r\n\t\t}\r\n\r\n\t\tif (x || y) {\r\n\t\t\tthis.state = this.direction === 1 ? STATE.moveForward : STATE.moveBackward;\r\n\t\t\tif (x * this.direction * this.sprite.animationSpeed < 0) {\r\n\t\t\t\tthis.sprite.animationSpeed = -this.sprite.animationSpeed;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (!x && !y) {\r\n\t\t\tthis.state = this.direction === 1 ? STATE.idleForward : STATE.idleBackward;\r\n\t\t}\r\n\t}\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/modules/player.js","export class Mouse {\r\n\tconstructor() {\r\n\t\tthis.x = 0;\r\n\t\tthis.y = 0;\r\n\t\twindow.addEventListener('mousemove', event => {\r\n\t\t\tthis.x = event.clientX;\r\n\t\t\tthis.y = event.clientY;\r\n\t\t});\r\n\t\twindow.addEventListener('mousedown', () => {\r\n\t\t\tthis.isClicked = true;\r\n\t\t});\r\n\t\twindow.addEventListener('mouseup', () => {\r\n\t\t\tthis.isClicked = false;\r\n\t\t});\r\n\t\twindow.addEventListener('blur', () => {\r\n\t\t\tthis.isClicked = false;\r\n\t\t});\r\n\t}\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/modules/mouse.js","import { Character } from './character';\r\n\r\nexport class Enemy extends Character {\r\n\tconstructor(world, player, config) {\r\n\t\tsuper(Math.floor(Math.random() * world.width - config.width), Math.floor(Math.random() * world.height - config.height), world, config);\r\n\t\tthis.name = config.name;\r\n\t\tthis.player = player;\r\n\t\tthis.damage = config.damage;\r\n\t\tthis.attackSpeed = config.attackSpeed;\r\n\t\tthis.award = config.award;\r\n\t}\r\n\r\n\tattackPlayer(delta) {\r\n\t\tif (Math.sqrt(Math.pow(Math.abs(this.x - this.player.x), 2) + Math.pow(Math.abs(this.y - this.player.y), 2)) > 60) {\r\n\t\t\tlet x = 0, y = 0;\r\n\r\n\t\t\tif (this.x > this.player.x) {\r\n\t\t\t\tx = -1\r\n\t\t\t}\r\n\t\t\telse if (this.x < this.player.x) {\r\n\t\t\t\tx = 1\r\n\t\t\t}\r\n\r\n\t\t\tif (this.y > this.player.y) {\r\n\t\t\t\ty = -1\r\n\t\t\t}\r\n\t\t\telse if (this.y < this.player.y) {\r\n\t\t\t\ty = 1\r\n\t\t\t}\r\n\r\n\t\t\tsuper.move(delta, x, y);\r\n\t\t} else {\r\n\t\t\t// attack\r\n\t\t\tif (!this.isAttacking) {\r\n\t\t\t\tthis.player.health -= this.damage;\r\n\t\t\t\tconsole.log('Player health - ' + this.player.health);\r\n\t\t\t\tthis.isAttacking = true;\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tthis.isAttacking = false;\r\n\t\t\t\t}, this.attackSpeed);\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/modules/enemy.js","export const KEYS = {\r\n\tup: 87,\r\n\tdown: 83,\r\n\tleft: 65,\r\n\tright: 68,\r\n\tpistol: 49,\r\n\tshotgun: 50,\r\n\tassaultRifle: 51,\r\n\treload: 82,\r\n\tpause: 27\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/modules/constants/keys.js","export const RESOURCES = {\r\n\timages: [\r\n\t\t'img/main.png',\r\n\t\t'img/pause.png',\r\n\t\t'img/gameOver.png',\r\n\t\t'img/map.png',\r\n\t\t'img/player.png',\r\n\t\t'img/playerActive.png',\r\n\t\t'img/aim.png',\r\n\t\t'img/weapon.png',\r\n\t\t'img/hole.png',\r\n\t\t'img/fire.png',\r\n\t\t'img/blood.png',\r\n\t\t'img/rat.png',\r\n\t],\r\n\tsounds: [\r\n\t\t'sound/background.mp3',\r\n\t\t'sound/trot.mp3',\r\n\t\t'sound/pickup.mp3',\r\n\t\t'sound/empty.mp3',\r\n\t\t'sound/pistol.mp3',\r\n\t\t'sound/pistolReload.mp3',\r\n\t\t'sound/shotgun.mp3',\r\n\t\t'sound/shotgunReload.mp3',\r\n\t\t'sound/assaultRifle.mp3',\r\n\t\t'sound/assaultRifleReload.mp3',\r\n\t\t'sound/ratAttack.mp3',\r\n\t\t'sound/ratDeath.mp3',\r\n\t]\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/modules/constants/resources.js","export const CHARACTERS = {\r\n\tplayer: {\r\n\t\tdefault: {\r\n\t\t\tsrc: 'img/player.png',\r\n\t\t\twidth: 106,\r\n\t\t\theight: 96,\r\n\t\t\tanimationSpeed: 16,\r\n\t\t\tmovementSpeed: 155,\r\n\t\t\thealth: 100\r\n\t\t},\r\n\t\tactive: {\r\n\t\t\tsrc: 'img/playerActive.png',\r\n\t\t\twidth: 106,\r\n\t\t\theight: 96,\r\n\t\t\tanimationSpeed: 16,\r\n\t\t\tmovementSpeed: 155,\r\n\t\t\thealth: 100\r\n\t\t}\r\n\t},\r\n\trat: {\r\n\t\tname: 'rat',\r\n\t\tsrc: 'img/rat.png',\r\n\t\twidth: 96.25,\r\n\t\theight: 46,\r\n\t\tanimationSpeed: 14,\r\n\t\tmovementSpeed: 100,\r\n\t\thealth: 50,\r\n\t\tdamage: 5,\r\n\t\tattackSpeed: 2000,\r\n\t\taward: 100\r\n\t}\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/modules/constants/characters.js","export const SPRITES = {\r\n\thole: {\r\n\t\tsrc: 'img/hole.png',\r\n\t\twidth: 10,\r\n\t\theight: 10\r\n\t},\r\n\tblood: {\r\n\t\tsrc: 'img/blood.png',\r\n\t\twidth: 50,\r\n\t\theight: 50\r\n\t},\r\n\tfire: {\r\n\t\tsrc: 'img/fire.png',\r\n\t\twidth: 50,\r\n\t\theight: 35\r\n\t},\r\n\tmap: {\r\n\t\tsrc: 'img/map.png',\r\n\t\twidth: 71,\r\n\t\theight: 71\r\n\t},\r\n\tpistol: {\r\n\t\tsrc: 'img/weapon.png',\r\n\t\twidth: 23,\r\n\t\theight: 16,\r\n\t\timagePosition: 0,\r\n\t},\r\n\tpistolBackward: {\r\n\t\tsrc: 'img/weapon.png',\r\n\t\twidth: 23,\r\n\t\theight: 16,\r\n\t\timagePosition: 16,\r\n\t},\r\n\tshotgun: {\r\n\t\tsrc: 'img/weapon.png',\r\n\t\twidth: 59,\r\n\t\theight: 21,\r\n\t\timagePosition: 32,\r\n\t},\r\n\tshotgunBackward: {\r\n\t\tsrc: 'img/weapon.png',\r\n\t\twidth: 59,\r\n\t\theight: 21,\r\n\t\timagePosition: 53\r\n\t},\r\n\tassaultRifle: {\r\n\t\tsrc: 'img/weapon.png',\r\n\t\twidth: 68,\r\n\t\theight: 16,\r\n\t\timagePosition: 74\r\n\t},\r\n\tassaultRifleBackward: {\r\n\t\tsrc: 'img/weapon.png',\r\n\t\twidth: 68,\r\n\t\theight: 16,\r\n\t\timagePosition: 90\r\n\t}\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/modules/constants/sprites.js"],"sourceRoot":""}