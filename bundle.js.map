{"version":3,"sources":["webpack:///webpack/bootstrap dd4ea7cf70ffa9f79323","webpack:///./src/modules/loader.js","webpack:///./src/modules/sprite.js","webpack:///./src/modules/character.js","webpack:///./src/modules/constants/states.js","webpack:///./src/modules/weapon.js","webpack:///./src/modules/constants/invertory.js","webpack:///./src/app.js","webpack:///./src/modules/game.js","webpack:///./src/modules/world.js","webpack:///./src/modules/keyboard.js","webpack:///./src/modules/camera.js","webpack:///./src/modules/player.js","webpack:///./src/modules/mouse.js","webpack:///./src/modules/enemy.js","webpack:///./src/modules/constants/keys.js","webpack:///./src/modules/constants/resources.js","webpack:///./src/modules/constants/characters.js","webpack:///./src/modules/constants/sprites.js"],"names":["images","sounds","successCallbacks","progressCallbacks","errorCallbacks","imagesCount","audioCount","totalCount","loadedCount","_loadImage","src","image","Image","onload","Object","keys","length","cb","percentage","Math","floor","_loadSound","audioDecoder","request","XMLHttpRequest","open","responseType","decodeAudioData","response","buffer","error","send","loadResources","resources","forEach","push","onprogress","onerror","getImage","getSound","Sprite","constructor","width","height","speed","imagePosition","framesCount","_index","update","delta","index","Character","x","y","world","config","sprite","animationSpeed","movementSpeed","health","state","STATES","idleForward","direction","isTileNotWalkable","tileSize","move","movedX","movedY","_isCollidedX","_isCollidedY","_updateState","_clampCoordinates","moveForward","moveBackward","idleBackward","maxX","columns","maxY","rows","max","min","attackForward","attackBackward","deathForward","deathBackward","Weapon","spriteForward","spritePosition","spriteBackward","name","fire","damage","capacity","bullets","reloadTime","availableBullets","shot","lastShot","Date","now","isShoted","reload","isReloading","onReload","console","log","setTimeout","INVERTORY","pistol","shotgun","assaultRifle","window","canvas","document","getElementById","innerWidth","innerHeight","addEventListener","context","getContext","AudioContext","webkitAudioContext","audioContext","game","run","Game","loopedSounds","init","bulletHoles","blood","weapons","enemies","score","keyboard","mouse","player","CHARACTERS","camera","follow","enemyInterval","setInterval","isPaused","rat","weaponInterval","probability","random","dirx","diry","isDown","KEYS","left","right","up","down","mousex","mousey","playLoopedSound","stopLoopedSound","weapon","invertory","currentItem","playSound","splice","indexOf","isEnemyHinted","isPlayerHinted","hitX","hitY","isClicked","isFlameAppeared","enemy","attackPlayer","award","SPRITES","hole","pause","gameOver","render","startCol","endCol","startRow","endRow","offsetX","offsetY","column","row","map","drawImage","round","screenX","screenY","aim","rect","strokeStyle","fillStyle","stroke","fillRect","font","textAlign","fillText","_previousElapsed","Loader","progress","style","display","appendChild","onclick","requestAnimationFrame","tick","bind","elapsed","clearRect","source","createBufferSource","connect","destination","start","volume","loop","gainNode","createGain","gain","value","stop","unpause","clearInterval","innerText","reset","World","possibility","getIndex","coordinate","Keyboard","keysPressed","key","onKeyDown","onKeyUp","event","keyCode","preventDefault","Camera","following","Player","defaultSprite","activeSprite","srcActive","STATE","Mouse","clientX","clientY","Enemy","attackSpeed","sqrt","pow","abs","isAttacking","_dealDamage","RESOURCES"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 6);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap dd4ea7cf70ffa9f79323","const images = {};\r\nconst sounds = {};\r\nconst successCallbacks = [], progressCallbacks = [], errorCallbacks = [];\r\nlet imagesCount = 0, audioCount = 0;\r\nlet totalCount = 0, loadedCount;\r\n\r\nconst _loadImage = (src) => {\r\n\tconst image = new Image();\r\n\timage.onload = () => {\r\n\t\timages[src] = image;\r\n\t\tloadedCount = Object.keys(images).length + Object.keys(sounds).length;\r\n\r\n\t\tfor (const cb of progressCallbacks) {\r\n\t\t\tcb({ percentage: Math.floor((loadedCount / totalCount) * 100) });\r\n\t\t}\r\n\t\tif (loadedCount === totalCount) {\r\n\t\t\tfor (const cb of successCallbacks) {\r\n\t\t\t\tcb();\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tfor (const cb of errorCallbacks) {\r\n\t\tcb('Couldn\\'t load image: ' + src);\r\n\t}\r\n\r\n\timage.src = src;\r\n};\r\n\r\nconst _loadSound = (src, audioDecoder) => {\r\n\tconst request = new XMLHttpRequest();\r\n\trequest.open('GET', src, true);\r\n\trequest.responseType = 'arraybuffer';\r\n\r\n\t// Decode asynchronously\r\n\trequest.onload = function() {\r\n\t\taudioDecoder.decodeAudioData(request.response, (buffer) => {\r\n\t\t\tsounds[src] = buffer;\r\n\t\t\tloadedCount = Object.keys(images).length + Object.keys(sounds).length;\r\n\t\t\tfor (const cb of progressCallbacks) {\r\n\t\t\t\tcb({ percentage: Math.floor((loadedCount / totalCount) * 100) });\r\n\t\t\t}\r\n\t\t\tif (loadedCount === totalCount) {\r\n\t\t\t\tfor (const cb of successCallbacks) {\r\n\t\t\t\t\tcb();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}, (error) => {\r\n\t\t\tfor (const cb of errorCallbacks) {\r\n\t\t\t\tcb('Couldn\\'t load sound: ' + src + '. ' + error);\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\trequest.send();\r\n};\r\n\r\nexport const loadResources = (resources, audioDecoder) => {\r\n\ttotalCount = resources.images.length + resources.sounds.length;\r\n\r\n\tresources.images.forEach(src => _loadImage(src));\r\n\tresources.sounds.forEach(src => _loadSound(src, audioDecoder));\r\n};\r\n\r\n// export const loadImages = (images) => {\r\n// \tif (images instanceof Array) {\r\n// \t\timagesCount = images.length;\r\n// \t\timages.forEach(src => _loadImage(src));\r\n// \t} else {\r\n// \t\timagesCount = 1;\r\n// \t\t_loadImage(images);\r\n// \t}\r\n// };\r\n\r\nexport const onload = (cb) => successCallbacks.push(cb);\r\n\r\nexport const onprogress = (cb) => progressCallbacks.push(cb);\r\n\r\nexport const onerror = (cb) => errorCallbacks.push(cb);\r\n\r\nexport const getImage = (src) => images[src];\r\n\r\nexport const getSound = (src) => sounds[src];\n\n\n// WEBPACK FOOTER //\n// ./src/modules/loader.js","import * as Loader from './loader';\r\n\r\nexport class Sprite {\r\n\tconstructor(src, width, height, speed, imagePosition) {\r\n\t\tthis.image = Loader.getImage(src);\r\n\t\tthis.width = width;\r\n\t\tthis.height = height;\r\n\t\tthis.speed = speed;\r\n\t\tthis.imagePosition = imagePosition;\r\n\t\tthis.framesCount = Math.floor(this.image.width / this.width);\r\n\t\tthis._index = 0;\r\n\t}\r\n\r\n\tupdate(delta) {\r\n\t\tif (this.speed) {\r\n\t\t\tthis._index += this.speed * delta;\r\n\t\t\tif (this._index > this.framesCount - 1) {\r\n\t\t\t\tthis._index = 0;\r\n\t\t\t}\r\n\t\t\tif (this._index < 0) {\r\n\t\t\t\tthis._index = this.framesCount - 1;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tset index(index) {\r\n\t\tthis._index= index;\r\n\t}\r\n\r\n\tget index() {\r\n\t\treturn Math.floor(this._index);\r\n\t}\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/modules/sprite.js","import { Sprite } from './sprite';\r\nimport { STATES } from './constants/states';\r\n\r\nexport class Character {\r\n\tconstructor(x, y, world, config) {\r\n\t\tthis.sprite = new Sprite(config.src, config.width, config.height, config.animationSpeed);\r\n\t\tthis.speed = config.movementSpeed;\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t\tthis.world = world;\r\n\t\tthis.health = config.health;\r\n\t\tthis.state = STATES.idleForward;\r\n\t\tthis.direction = 1;\r\n\r\n\t\twhile (this.world.isTileNotWalkable(this.x + this.sprite.width / 2, this.y + this.sprite.height)) {\r\n\t\t\tthis.x = this.x < this.world.width / 2 ? this.x + this.world.tileSize : this.x - this.world.tileSize;\r\n\t\t\tthis.y = this.x < this.world.height / 2 ? this.y + this.world.tileSize : this.y - this.world.tileSize;\r\n\t\t}\r\n\t}\r\n\r\n\tmove(delta, x, y) {\r\n\t\tlet movedX = x * this.speed * delta, movedY = y * this.speed * delta;\r\n\r\n\t\tif (this._isCollidedX(movedX)) {\r\n\t\t\tmovedX = 0;\r\n\t\t\tx = 0\r\n\t\t}\r\n\r\n\t\tif (this._isCollidedY(movedY)) {\r\n\t\t\tmovedY = 0;\r\n\t\t\ty = 0\r\n\t\t}\r\n\r\n\t\tthis._updateState(x, y);\r\n\r\n\t\tthis.x += movedX;\r\n\t\tthis.y += movedY;\r\n\r\n\t\t// clamp values\r\n\t\tthis._clampCoordinates();\r\n\t}\r\n\r\n\t_updateState(x, y) {\r\n\t\tif (x) {\r\n\t\t\tthis.direction = x;\r\n\t\t}\r\n\r\n\t\tif (x || y) {\r\n\t\t\tthis.state = this.direction === 1 ? STATES.moveForward : STATES.moveBackward;\r\n\t\t}\r\n\r\n\t\tif (!x && !y) {\r\n\t\t\tthis.state = this.direction === 1 ? STATES.idleForward : STATES.idleBackward;\r\n\t\t}\r\n\t}\r\n\r\n\t// _collide(x, y) {\r\n\t// \t// check for collisions on sprite sides\r\n\t// \tif (this.x < 0 || (this.x + this.sprite.width) > this.world.width || this.y < 0 || (this.y + this.sprite.height) > this.world.height || // Bounds\r\n\t// \t\tthis.world.isTileNotWalkable(this.x + this.sprite.width / 2, this.y + this.sprite.height)) { // Rocks\r\n\t// \t\tthis.y -= y;\r\n\t// \t\tthis.x -= x;\r\n\t//\r\n\t// \t\treturn true;\r\n\t// \t}\r\n\t//\r\n\t// \treturn false;\r\n\t// }\r\n\r\n\t_isCollidedX(x) {\r\n\t\treturn this.x + x < 0 || (this.x + x + this.sprite.width) > this.world.width || this.world.isTileNotWalkable(this.x + x + this.sprite.width / 2, this.y + this.sprite.height);\r\n\t}\r\n\r\n\t_isCollidedY(y) {\r\n\t\treturn this.y + y < 0 || (this.y + y + this.sprite.height) > this.world.height || this.world.isTileNotWalkable(this.x + this.sprite.width / 2, this.y + y + this.sprite.height);\r\n\t}\r\n\r\n\t_clampCoordinates() {\r\n\t\tconst maxX = this.world.columns * this.world.tileSize;\r\n\t\tconst maxY = this.world.rows * this.world.tileSize;\r\n\t\tthis.x = Math.max(0, Math.min(this.x, maxX));\r\n\t\tthis.y = Math.max(0, Math.min(this.y, maxY));\r\n\t}\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/modules/character.js","export const STATES = {\r\n\tidleForward: 0,\r\n\tidleBackward: 1,\r\n\tmoveForward: 2,\r\n\tmoveBackward: 3,\r\n\tattackForward: 4,\r\n\tattackBackward: 5,\r\n\tdeathForward: 6,\r\n\tdeathBackward: 7\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/modules/constants/states.js","import { Sprite } from './sprite';\r\nimport * as Loader from './loader';\r\n\r\nexport class Weapon {\r\n\tconstructor(config) {\r\n\t\tthis.spriteForward = new Sprite('img/weapon.png', config.width, config.height, 0, config.spritePosition);\r\n\t\tthis.spriteBackward = new Sprite('img/weapon.png', config.width, config.height, 0, config.spritePosition + config.height);\r\n\t\tthis.sprite = this.spriteForward;\r\n\t\tthis.name = config.name;\r\n\t\tthis.fire = new Sprite('img/fire.png', 50, 35);\r\n\t\tthis.damage = config.damage;\r\n\t\tthis.capacity = config.capacity;\r\n\t\tthis.bullets = config.bullets;\r\n\t\tthis.reloadTime = config.reloadTime;\r\n\t\tthis.speed = config.speed;\r\n\t\tthis.availableBullets = config.capacity;\r\n\t}\r\n\r\n\tshot() {\r\n\t\tif (this.availableBullets) {\r\n\t\t\tif (this.speed) {\r\n\t\t\t\tif (!this.lastShot || Date.now() - this.lastShot > this.speed) {\r\n\t\t\t\t\tthis.lastShot = Date.now();\r\n\t\t\t\t\tthis.availableBullets--;\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t} else if (!this.isShoted) {\r\n\t\t\t\tthis.isShoted = true;\r\n\t\t\t\tthis.availableBullets--;\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.reload();\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\treload() {\r\n\t\tif (this.bullets && this.availableBullets < this.capacity && !this.isReloading) {\r\n\t\t\tif (this.onReload) {\r\n\t\t\t\tthis.onReload();\r\n\t\t\t}\r\n\r\n\t\t\tconsole.log('reloading...');\r\n\t\t\tthis.isReloading = true;\r\n\t\t\tthis.bullets += this.availableBullets;\r\n\t\t\tthis.availableBullets = 0;\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tthis.availableBullets = this.bullets >= this.capacity ? this.capacity : this.bullets % this.capacity;\r\n\t\t\t\tthis.bullets = this.bullets >= this.capacity ? this.bullets - this.capacity : 0;\r\n\t\t\t\tthis.isReloading = false;\r\n\t\t\t}, this.reloadTime)\r\n\t\t}\r\n\t}\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/modules/weapon.js","export const INVERTORY = {\r\n\tpistol: {\r\n\t\tname: 'pistol',\r\n\t\twidth: 23,\r\n\t\theight: 16,\r\n\t\tspritePosition: 0,\r\n\t\tdamage: 9,\r\n\t\tcapacity: 7,\r\n\t\tbullets: 35,\r\n\t\treloadTime: 1500,\r\n\t\tspeed: 0\r\n\t},\r\n\tshotgun: {\r\n\t\tname: 'shotgun',\r\n\t\twidth: 59,\r\n\t\theight: 21,\r\n\t\tspritePosition: 32,\r\n\t\tdamage: 50,\r\n\t\tcapacity: 2,\r\n\t\tbullets: 20,\r\n\t\treloadTime: 2500,\r\n\t\tspeed: 0\r\n\t},\r\n\tassaultRifle: {\r\n\t\tname: 'assaultRifle',\r\n\t\twidth: 68,\r\n\t\theight: 16,\r\n\t\tspritePosition: 74,\r\n\t\tdamage: 20,\r\n\t\tcapacity: 30,\r\n\t\tbullets: 120,\r\n\t\treloadTime: 2500,\r\n\t\tspeed: 125\r\n\t}\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/modules/constants/invertory.js","import { Game } from './modules/game';\r\n\r\nwindow.onload = () => {\r\n\tconst canvas = document.getElementById('game');\r\n\tcanvas.width = window.innerWidth;\r\n\tcanvas.height = window.innerHeight;\r\n\twindow.addEventListener('resize', () => {\r\n\t\tcanvas.width = window.innerWidth;\r\n\t\tcanvas.height = window.innerHeight;\r\n\t});\r\n\tconst context = canvas.getContext('2d');\r\n\r\n\twindow.AudioContext = window.AudioContext || window.webkitAudioContext;\r\n\tconst audioContext = new AudioContext();\r\n\r\n\tconst game = new Game(context, audioContext);\r\n\tgame.run();\r\n};\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/app.js","import * as Loader from './loader';\r\nimport { World } from './world';\r\nimport { Keyboard } from './keyboard';\r\nimport { Camera } from './camera';\r\nimport { Player } from './player';\r\nimport { Mouse } from './mouse';\r\nimport { Sprite } from './sprite';\r\nimport { Enemy } from './enemy';\r\nimport { KEYS } from './constants/keys';\r\nimport { INVERTORY } from './constants/invertory';\r\nimport { Weapon } from './weapon';\r\nimport { RESOURCES } from './constants/resources';\r\nimport { CHARACTERS } from './constants/characters';\r\nimport { SPRITES } from './constants/sprites';\r\n\r\nexport class Game {\r\n\tconstructor(context, audioContext) {\r\n\t\tthis.context = context;\r\n\t\tthis.audioContext = audioContext;\r\n\t\tthis.loopedSounds = {};\r\n\t}\r\n\r\n\tinit() {\r\n\t\tthis.bulletHoles = [];\r\n\t\tthis.blood = [];\r\n\t\tthis.weapons = [];\r\n\t\tthis.enemies = [];\r\n\t\tthis.score = 0;\r\n\t\tthis.world = new World(30, 30, 71, 'img/map.png');\r\n\t\tthis.keyboard = new Keyboard(KEYS);\r\n\t\tthis.mouse = new Mouse();\r\n\t\tthis.player = new Player(this.world, CHARACTERS.player);\r\n\t\tthis.camera = new Camera(this.world);\r\n\t\tthis.camera.follow(this.player);\r\n\r\n\t\tthis.enemyInterval = setInterval(() => {\r\n\t\t\tif (!this.isPaused)  {\r\n\t\t\t\tthis.enemies.push(new Enemy(this.world, this.player, CHARACTERS.rat));\r\n\t\t\t\tconsole.log('Generated enemy');\r\n\t\t\t}\r\n\t\t}, 3000);\r\n\t\tthis.weaponInterval = setInterval(() => {\r\n\t\t\tif (!this.isPaused) {\r\n\t\t\t\tconst probability = Math.random();\r\n\t\t\t\tif (this.score >= 3000 && probability < 0.5) {\r\n\t\t\t\t\tthis.weapons.push(new Weapon(INVERTORY.assaultRifle));\r\n\t\t\t\t} else if (this.score >= 1000 && probability < 0.5) {\r\n\t\t\t\t\tthis.weapons.push(new Weapon(INVERTORY.shotgun));\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.weapons.push(new Weapon(INVERTORY.pistol));\r\n\t\t\t\t}\r\n\t\t\t\tthis.weapons[this.weapons.length - 1].x = Math.random() * this.world.width;\r\n\t\t\t\tthis.weapons[this.weapons.length - 1].y = Math.random() * this.world.height;\r\n\r\n\t\t\t\tconsole.log('Generated weapon');\r\n\t\t\t}\r\n\t\t}, 10000);\r\n\t}\r\n\r\n\tupdate(delta) {\r\n\t\tlet dirx = 0, diry = 0;\r\n\r\n\t\tif (this.keyboard.isDown(KEYS.left)) { dirx = -1; }\r\n\t\telse if (this.keyboard.isDown(KEYS.right)) { dirx = 1; }\r\n\r\n\t\tif (this.keyboard.isDown(KEYS.up)) { diry = -1; }\r\n\t\telse if (this.keyboard.isDown(KEYS.down)) { diry = 1; }\r\n\r\n\t\tthis.player.mousex = this.mouse.x;\r\n\t\tthis.player.mousey = this.mouse.y;\r\n\r\n\t\tthis.player.sprite.update(delta);\r\n\t\tthis.player.move(delta, dirx, diry);\r\n\r\n\t\tif ((dirx || diry) && !this.loopedSounds['trot']) {\r\n\t\t\tthis.playLoopedSound(Loader.getSound('sound/trot.mp3'), 'trot');\r\n\t\t} else if (!dirx && !diry && this.loopedSounds['trot']) {\r\n\t\t\tthis.stopLoopedSound('trot');\r\n\t\t}\r\n\r\n\t\tfor (let weapon of this.weapons) {\r\n\t\t\tif (weapon.x >= this.player.x &&\r\n\t\t\t\tweapon.x <= this.player.x + this.player.sprite.width &&\r\n\t\t\t\tweapon.y >= this.player.y &&\r\n\t\t\t\tweapon.y <= this.player.y + this.player.sprite.height) {\r\n\t\t\t\tif (this.player.invertory[weapon.name]) {\r\n\t\t\t\t\tthis.player.invertory[weapon.name].bullets += weapon.bullets;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.player.invertory[weapon.name] = weapon;\r\n\t\t\t\t\tthis.player.currentItem = weapon;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.playSound(Loader.getSound('sound/pickup.mp3'));\r\n\r\n\t\t\t\tthis.weapons.splice(this.weapons.indexOf(weapon), 1);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.keyboard.isDown(KEYS.pistol) && this.player.invertory.pistol && this.player.invertory.pistol.bullets && (!this.player.currentItem || this.player.currentItem.name !== 'pistol')) {\r\n\t\t\tthis.player.currentItem = this.player.invertory.pistol;\r\n\t\t\tthis.playSound(Loader.getSound('sound/pickup.mp3'));\r\n\t\t}\r\n\r\n\t\tif (this.keyboard.isDown(KEYS.shotgun) && this.player.invertory.shotgun && this.player.invertory.shotgun.bullets && (!this.player.currentItem || this.player.currentItem.name !== 'shotgun')) {\r\n\t\t\tthis.player.currentItem = this.player.invertory.shotgun;\r\n\t\t\tthis.playSound(Loader.getSound('sound/pickup.mp3'));\r\n\t\t}\r\n\r\n\t\tif (this.keyboard.isDown(KEYS.assaultRifle) && this.player.invertory.assaultRifle && this.player.invertory.assaultRifle.bullets && (!this.player.currentItem || this.player.currentItem.name !== 'assaultRifle')) {\r\n\t\t\tthis.player.currentItem = this.player.invertory.assaultRifle;\r\n\t\t\tthis.playSound(Loader.getSound('sound/pickup.mp3'));\r\n\t\t}\r\n\r\n\t\tlet isEnemyHinted = false, isPlayerHinted, hitX, hitY;\r\n\r\n\t\tif (this.player.currentItem) {\r\n\t\t\tif (!this.player.currentItem.onReload) {\r\n\t\t\t\tthis.player.currentItem.onReload = () => this.playSound(Loader.getSound('sound/' + this.player.currentItem.name + 'Reload.mp3'))\r\n\t\t\t}\r\n\t\t\tif (!this.player.currentItem.availableBullets && !this.player.currentItem.bullets) {\r\n\t\t\t\tthis.player.invertory[this.player.currentItem.name] = null;\r\n\t\t\t\tthis.player.currentItem = null;\r\n\t\t\t} else {\r\n\t\t\t\tif (this.keyboard.isDown(KEYS.reload)) {\r\n\t\t\t\t\tthis.player.currentItem.reload();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (this.mouse.isClicked && !this.player.currentItem.isShoted && !this.player.currentItem.isReloading) {\r\n\t\t\t\t\tif (this.player.currentItem.shot()) {\r\n\t\t\t\t\t\thitX = this.camera.x + this.mouse.x;\r\n\t\t\t\t\t\thitY = this.camera.y + this.mouse.y;\r\n\t\t\t\t\t\tconsole.log(this.player.currentItem.availableBullets  + ' / '  + this.player.currentItem.bullets);\r\n\t\t\t\t\t\tthis.isFlameAppeared = true;\r\n\t\t\t\t\t\tsetTimeout(() => this.isFlameAppeared = false, 50);\r\n\t\t\t\t\t\tthis.playSound(Loader.getSound('sound/' + this.player.currentItem.name + '.mp3'));\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (!this.mouse.isClicked) { // We also have non-automatic weapons (pistol, shotgun)\r\n\t\t\t\t\tthis.player.currentItem.isShoted = false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Update enemies state\r\n\t\tfor (let enemy of this.enemies) {\r\n\t\t\tenemy.sprite.update(delta);\r\n\r\n\t\t\tif (enemy.attackPlayer(delta) && !isPlayerHinted) {\r\n\t\t\t\tthis.playSound(Loader.getSound('sound/' + enemy.name + 'Attack.mp3'));\r\n\t\t\t\tisPlayerHinted = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (hitX && hitY) {\r\n\t\t\t\tif (hitX >= enemy.x && hitX <= enemy.x + enemy.sprite.width &&\r\n\t\t\t\t\thitY >= enemy.y && hitY <= enemy.y + enemy.sprite.height) {\r\n\t\t\t\t\tenemy.health -= this.player.currentItem.damage;\r\n\t\t\t\t\tisEnemyHinted = true;\r\n\r\n\t\t\t\t\tconsole.log('Enemy health - ' + enemy.health);\r\n\t\t\t\t\tif (enemy.health <= 0) {\r\n\t\t\t\t\t\tthis.playSound(Loader.getSound('sound/' + enemy.name + 'Death.mp3'));\r\n\t\t\t\t\t\tthis.enemies.splice(this.enemies.indexOf(enemy), 1);\r\n\t\t\t\t\t\tthis.score += enemy.award;\r\n\t\t\t\t\t\tconsole.log('Score - ' + this.score);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (isPlayerHinted) {\r\n\t\t\tlet blood = new Sprite(SPRITES.blood.src, SPRITES.blood.width, SPRITES.blood.height);\r\n\t\t\tblood.index = Math.random() * blood.framesCount;\r\n\t\t\tthis.blood.push({\r\n\t\t\t\tx: this.player.x + this.player.sprite.width / 2,\r\n\t\t\t\ty: this.player.y + this.player.sprite.height / 2,\r\n\t\t\t\tsprite: blood\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (hitX && hitY) {\r\n\t\t\tif (isEnemyHinted) {\r\n\t\t\t\tlet blood = new Sprite(SPRITES.blood.src, SPRITES.blood.width, SPRITES.blood.height);\r\n\t\t\t\tblood.index = Math.random() * blood.framesCount;\r\n\t\t\t\tthis.blood.push({\r\n\t\t\t\t\tx: hitX,\r\n\t\t\t\t\ty: hitY,\r\n\t\t\t\t\tsprite: blood\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tthis.bulletHoles.push({\r\n\t\t\t\t\tx: hitX,\r\n\t\t\t\t\ty: hitY,\r\n\t\t\t\t\tsprite: new Sprite(SPRITES.hole.src, SPRITES.hole.width, SPRITES.hole.height)\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.camera.update();\r\n\r\n\t\tif (this.keyboard.isDown(KEYS.pause)) {\r\n\t\t\tthis.pause();\r\n\t\t}\r\n\r\n\t\tif (this.player.health <= 0) {\r\n\t\t\treturn this.gameOver();\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\t// Render map\r\n\t\tconst startCol = Math.floor(this.camera.x / this.world.tileSize);\r\n\t\tconst endCol = startCol + (this.camera.width / this.world.tileSize);\r\n\t\tconst startRow = Math.floor(this.camera.y / this.world.tileSize);\r\n\t\tconst endRow = startRow + (this.camera.height / this.world.tileSize);\r\n\t\tconst offsetX = -this.camera.x + startCol * this.world.tileSize;\r\n\t\tconst offsetY = -this.camera.y + startRow * this.world.tileSize;\r\n\r\n\t\tfor (let column = startCol; column <= endCol + 1; column++) {\r\n\t\t\tfor (let row = startRow; row <= endRow + 1; row++) {\r\n\t\t\t\tif (this.world.map[row]){\r\n\t\t\t\t\tlet x = (column - startCol) * this.world.tileSize + offsetX;\r\n\t\t\t\t\tlet y = (row - startRow) * this.world.tileSize + offsetY;\r\n\t\t\t\t\tthis.context.drawImage(\r\n\t\t\t\t\t\tthis.world.image, // image\r\n\t\t\t\t\t\tthis.world.map[row][column] * this.world.tileSize, // source x\r\n\t\t\t\t\t\t0, // source y\r\n\t\t\t\t\t\tthis.world.tileSize, // source width\r\n\t\t\t\t\t\tthis.world.tileSize, // source height\r\n\t\t\t\t\t\tMath.round(x),  // target x\r\n\t\t\t\t\t\tMath.round(y), // target y\r\n\t\t\t\t\t\tthis.world.tileSize, // target width\r\n\t\t\t\t\t\tthis.world.tileSize // target height\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Render blood\r\n\t\tfor (const blood of this.blood) {\r\n\t\t\tif ((blood.x >= this.camera.x && blood.y >= this.camera.y) &&\r\n\t\t\t\t(blood.x <= this.camera.x + window.innerWidth && blood.y <= this.camera.y + window.innerHeight)) {\r\n\t\t\t\tthis.context.drawImage(\r\n\t\t\t\t\tblood.sprite.image,\r\n\t\t\t\t\tblood.sprite.index * blood.sprite.width,\r\n\t\t\t\t\t0,\r\n\t\t\t\t\tblood.sprite.width,\r\n\t\t\t\t\tblood.sprite.height,\r\n\t\t\t\t\tblood.x - this.camera.x - blood.sprite.width / 2,\r\n\t\t\t\t\tblood.y - this.camera.y - blood.sprite.height / 2,\r\n\t\t\t\t\tblood.sprite.width,\r\n\t\t\t\t\tblood.sprite.height,\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Render bullet holes\r\n\t\tfor (const hole of this.bulletHoles) {\r\n\t\t\tif ((hole.x >= this.camera.x && hole.y >= this.camera.y) &&\r\n\t\t\t\t(hole.x <= this.camera.x + window.innerWidth && hole.y <= this.camera.y + window.innerHeight)) {\r\n\t\t\t\tthis.context.drawImage(\r\n\t\t\t\t\thole.sprite.image,\r\n\t\t\t\t\thole.x - this.camera.x - hole.sprite.width / 2,\r\n\t\t\t\t\thole.y - this.camera.y - hole.sprite.height / 2\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Render weapons\r\n\t\tfor (const weapon of this.weapons) {\r\n\t\t\tif ((weapon.x >= this.camera.x && weapon.y >= this.camera.y) &&\r\n\t\t\t\t(weapon.x <= this.camera.x + window.innerWidth && weapon.y <= this.camera.y + window.innerHeight)) {\r\n\t\t\t\tthis.context.drawImage(\r\n\t\t\t\t\tweapon.sprite.image,\r\n\t\t\t\t\t0,\r\n\t\t\t\t\tweapon.sprite.imagePosition,\r\n\t\t\t\t\tweapon.sprite.width,\r\n\t\t\t\t\tweapon.sprite.height,\r\n\t\t\t\t\tweapon.x - this.camera.x - weapon.sprite.width / 2,\r\n\t\t\t\t\tweapon.y - this.camera.y - weapon.sprite.height / 2,\r\n\t\t\t\t\tweapon.sprite.width,\r\n\t\t\t\t\tweapon.sprite.height,\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Render player\r\n\t\tthis.context.drawImage(\r\n\t\t\tthis.player.sprite.image,\r\n\t\t\tthis.player.sprite.index * this.player.sprite.width,\r\n\t\t\tthis.player.state * this.player.sprite.height,\r\n\t\t\tthis.player.sprite.width,\r\n\t\t\tthis.player.sprite.height,\r\n\t\t\tthis.player.screenX,\r\n\t\t\tthis.player.screenY,\r\n\t\t\tthis.player.sprite.width,\r\n\t\t\tthis.player.sprite.height);\r\n\r\n\t\t// Render enemies\r\n\t\tfor (let enemy of this.enemies) {\r\n\t\t\tthis.context.drawImage(\r\n\t\t\t\tenemy.sprite.image,\r\n\t\t\t\tenemy.sprite.index * enemy.sprite.width,\r\n\t\t\t\tenemy.state * enemy.sprite.height,\r\n\t\t\t\tenemy.sprite.width,\r\n\t\t\t\tenemy.sprite.height,\r\n\t\t\t\tenemy.x - this.camera.x,\r\n\t\t\t\tenemy.y - this.camera.y,\r\n\t\t\t\tenemy.sprite.width,\r\n\t\t\t\tenemy.sprite.height);\r\n\t\t}\r\n\r\n\t\t// Render player's weapon\r\n\t\tif (this.player.currentItem && !this.player.currentItem.isReloading) {\r\n\t\t\tthis.context.drawImage(\r\n\t\t\t\tthis.player.currentItem.sprite.image,\r\n\t\t\t\t0,\r\n\t\t\t\tthis.player.currentItem.sprite.imagePosition,\r\n\t\t\t\tthis.player.currentItem.sprite.width,\r\n\t\t\t\tthis.player.currentItem.sprite.height,\r\n\t\t\t\tthis.player.direction > 0 ? this.player.screenX + this.player.sprite.width : this.player.screenX - this.player.currentItem.sprite.width,\r\n\t\t\t\tthis.player.screenY + 35,\r\n\t\t\t\tthis.player.currentItem.sprite.width,\r\n\t\t\t\tthis.player.currentItem.sprite.height,\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\t// Render weapon fire\r\n\t\tif (this.player.currentItem && this.isFlameAppeared) {\r\n\t\t\tthis.context.drawImage(\r\n\t\t\t\tthis.player.currentItem.fire.image,\r\n\t\t\t\t0,\r\n\t\t\t\tthis.player.direction > 0 ? 0 : this.player.currentItem.fire.height,\r\n\t\t\t\tthis.player.currentItem.fire.width,\r\n\t\t\t\tthis.player.currentItem.fire.height,\r\n\t\t\t\tthis.player.direction > 0 ?\r\n\t\t\t\t\tthis.player.screenX + this.player.sprite.width + this.player.currentItem.sprite.width :\r\n\t\t\t\t\tthis.player.screenX - this.player.currentItem.sprite.width - 50,\r\n\t\t\t\tthis.player.screenY + 23,\r\n\t\t\t\tthis.player.currentItem.fire.width,\r\n\t\t\t\tthis.player.currentItem.fire.height,\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\t// Render aim\r\n\t\tlet aim = Loader.getImage('img/aim.png');\r\n\t\tthis.context.drawImage(\r\n\t\t\taim,\r\n\t\t\tthis.mouse.x - (aim.width / 2),\r\n\t\t\tthis.mouse.y - (aim.height / 2)\r\n\t\t);\r\n\r\n\t\t// Render HUD\r\n\t\tthis.context.rect(70, window.innerHeight - 100, 400, 25);\r\n\r\n\t\t// Health bar\r\n\t\tthis.context.strokeStyle = '#14ff17';\r\n\t\tthis.context.fillStyle = '#14ff17';\r\n\t\tthis.context.stroke();\r\n\t\tthis.context.fillRect(70, window.innerHeight - 100, 400 * (this.player.health / 100), 25);\r\n\r\n\t\t// Text style\r\n\t\tthis.context.font='36px Overseer';\r\n\t\tthis.context.textAlign='center';\r\n\r\n\t\t// Score\r\n\t\tthis.context.fillText('Score: ' + this.score, window.innerWidth / 2, window.innerHeight - 75);\r\n\r\n\t\t// Weapon\r\n\t\tif (this.player.currentItem) {\r\n\t\t\tthis.context.fillText(this.player.currentItem.availableBullets + ' / ' + this.player.currentItem.bullets, window.innerWidth - 100, window.innerHeight - 75);\r\n\t\t}\r\n\t}\r\n\r\n\trun() {\r\n\t\tthis._previousElapsed = 0;\r\n\t\tLoader.onprogress(progress => {\r\n\t\t\tconsole.log(progress.percentage);\r\n\t\t\tdocument.getElementById('loadingBar').style.width = progress.percentage + '%';\r\n\t\t});\r\n\t\tLoader.onload(() => {\r\n\t\t\tthis.playLoopedSound(Loader.getSound('sound/background.mp3'), 'background', 0.2);\r\n\t\t\tdocument.getElementById('loading').style.display = 'none';\r\n\t\t\tdocument.getElementById('menu').style.display = 'block';\r\n\r\n\t\t\tdocument.getElementById('mainImage').appendChild(Loader.getImage('img/main.png'));\r\n\r\n\t\t\tdocument.getElementById('start').onclick = () => {\r\n\t\t\t\tdocument.getElementById('main').style.display = 'none';\r\n\t\t\t\tthis.init();\r\n\t\t\t\twindow.requestAnimationFrame(this.tick.bind(this));\r\n\t\t\t}\r\n\t\t});\r\n\t\tLoader.loadResources(RESOURCES, this.audioContext);\r\n\t}\r\n\r\n\ttick(elapsed) {\r\n\t\tif (!this.isPaused) {\r\n\t\t\twindow.requestAnimationFrame(this.tick.bind(this));\r\n\r\n\t\t\t// clear previous frame\r\n\t\t\tthis.context.clearRect(0, 0, window.innerWidth, window.innerHeight);\r\n\r\n\t\t\t// compute delta time in seconds -- also cap it\r\n\t\t\tlet delta = (elapsed - this._previousElapsed) / 1000.0;\r\n\t\t\tdelta = Math.min(delta, 0.25); // maximum delta of 250 ms\r\n\t\t\tthis._previousElapsed = elapsed;\r\n\r\n\t\t\tthis.update(delta);\r\n\t\t\tthis.render();\r\n\t\t}\r\n\t}\r\n\r\n\tplaySound(buffer) {\r\n\t\tconst source = this.audioContext.createBufferSource(); // creates a sound source\r\n\t\tsource.buffer = buffer; // tell the source which sound to play\r\n\t\tsource.connect(this.audioContext.destination); // connect the source to the context's destination (the speakers)\r\n\t\tsource.start(0);\r\n\t}\r\n\r\n\tplayLoopedSound(buffer, name, volume = 1) {\r\n\t\tconst source = this.audioContext.createBufferSource(); // creates a sound source\r\n\t\tsource.buffer = buffer; // tell the source which sound to play\r\n\t\tsource.loop = true;\r\n\t\tconst gainNode = this.audioContext.createGain(); // Connect the source to the gain node.\r\n\t\tsource.connect(gainNode); // Connect the gain node to the destination.\r\n\t\tgainNode.connect(this.audioContext.destination);\r\n\t\tgainNode.gain.value = volume;\r\n\r\n\t\tthis.loopedSounds[name] = source;\r\n\r\n\t\tsource.start(0);\r\n\t}\r\n\r\n\tstopLoopedSound(name) {\r\n\t\tthis.loopedSounds[name].stop();\r\n\t\tthis.loopedSounds[name] = null;\r\n\t}\r\n\r\n\tpause() {\r\n\t\tthis.isPaused = true;\r\n\r\n\t\tif (this.loopedSounds['trot']) {\r\n\t\t\tthis.loopedSounds['trot'].stop();\r\n\t\t\tthis.loopedSounds['trot'] = null;\r\n\t\t}\r\n\r\n\t\tdocument.getElementById('pause').style.display = 'block';\r\n\t\tdocument.getElementById('pauseImage').appendChild(Loader.getImage('img/pause.png'));\r\n\t\tdocument.getElementById('resume').onclick = this.unpause.bind(this);\r\n\t}\r\n\r\n\tunpause() {\r\n\t\tdocument.getElementById('pause').style.display = 'none';\r\n\t\tthis.isPaused = false;\r\n\t\twindow.requestAnimationFrame(this.tick.bind(this));\r\n\t}\r\n\r\n\tgameOver() {\r\n\t\tconsole.log('Game over');\r\n\t\tthis.isPaused = true;\r\n\t\tclearInterval(this.enemyInterval);\r\n\t\tclearInterval(this.weaponInterval);\r\n\r\n\t\tif (this.loopedSounds['trot']) {\r\n\t\t\tthis.loopedSounds['trot'].stop();\r\n\t\t\tthis.loopedSounds['trot'] = null;\r\n\t\t}\r\n\r\n\t\tdocument.getElementById('gameOver').style.display = 'block';\r\n\t\tdocument.getElementById('gameOverImage').appendChild(Loader.getImage('img/gameOver.png'));\r\n\t\tdocument.getElementById('score').innerText= this.score;\r\n\t\tdocument.getElementById('tryAgain').onclick = this.reset.bind(this);\r\n\t}\r\n\r\n\treset() {\r\n\t\tdocument.getElementById('gameOver').style.display = 'none';\r\n\r\n\t\tthis.init();\r\n\t\tthis.isPaused = false;\r\n\t\twindow.requestAnimationFrame(this.tick.bind(this));\r\n\t}\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/modules/game.js","import * as Loader from './loader';\r\n\r\nexport class World {\r\n\tconstructor(rows, columns, tileSize, src) {\r\n\t\tthis.rows = rows;\r\n\t\tthis.columns = columns;\r\n\t\tthis.tileSize = tileSize;\r\n\t\tthis.width = columns * tileSize;\r\n\t\tthis.height = rows * tileSize;\r\n\t\tthis.image = Loader.getImage(src);\r\n\r\n\t\tthis.map = [];\r\n\t\tfor (let row = 0; row < rows; row++) {\r\n\t\t\tthis.map[row] = [];\r\n\t\t\tfor (let column = 0; column < columns; column++) {\r\n\t\t\t\t// if (row === 0 || column === 0 || row === rows - 1 || column === columns - 1) {\r\n\t\t\t\t// \tthis.map[row][column] = 4;\r\n\t\t\t\t// } else {\r\n\t\t\t\t// \tthis.map[row][column] = 0;\r\n\t\t\t\t// }\r\n\r\n\t\t\t\tconst possibility = Math.random(); // We gonna put some rocks\r\n\t\t\t\tif (possibility < 0.1) {\r\n\t\t\t\t\tthis.map[row][column] = Math.floor(Math.random() * 5)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.map[row][column] = 0\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tgetIndex(coordinate) {\r\n\t\treturn Math.floor(coordinate / this.tileSize);\r\n\t}\r\n\r\n\tisTileNotWalkable(x, y) {\r\n\t\tconst row = this.getIndex(y);\r\n\t\tconst column = this.getIndex(x);\r\n\r\n\t\treturn this.map[row] && this.map[row][column] > 0;\r\n\t}\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/modules/world.js","export class Keyboard {\r\n\tconstructor(keys) {\r\n\t\tthis.keysPressed = {};\r\n\t\t// keys.forEach((key) => {\r\n\t\t// \tthis.keysPressed[key] = false;\r\n\t\t// });\r\n\t\t// for (const key in keys) {\r\n\t\t// \tthis.keysPressed[keys[key]] = false;\r\n\t\t// }\r\n\r\n\t\tfor (const key of Object.keys(keys)) {\r\n\t\t\tthis.keysPressed[keys[key]] = false;\r\n\t\t}\r\n\r\n\t\twindow.addEventListener('keydown', this.onKeyDown.bind(this));\r\n\t\twindow.addEventListener('keyup', this.onKeyUp.bind(this));\r\n\t\twindow.addEventListener('blur', () => {\r\n\t\t\tfor (const key of Object.keys(keys)) {\r\n\t\t\t\tthis.keysPressed[keys[key]] = false;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tonKeyDown(event) {\r\n\t\tconst keyCode = event.keyCode;\r\n\t\tif (keyCode in this.keysPressed) {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tthis.keysPressed[keyCode] = true;\r\n\t\t}\r\n\t}\r\n\r\n\tonKeyUp(event) {\r\n\t\tconst keyCode = event.keyCode;\r\n\t\tif (keyCode in this.keysPressed) {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tthis.keysPressed[keyCode] = false;\r\n\t\t}\r\n\t}\r\n\r\n\tisDown(keyCode) {\r\n\t\treturn this.keysPressed[keyCode];\r\n\t};\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/modules/keyboard.js","export class Camera {\r\n\tconstructor(map) {\r\n\t\tthis.width = window.innerWidth;\r\n\t\tthis.height = window.innerHeight;\r\n\t\tthis.maxX = map.columns * map.tileSize - this.width;\r\n\t\tthis.maxY = map.rows * map.tileSize - this.height;\r\n\t\tthis.x = this.width / 2;\r\n\t\tthis.y = this.height / 2;\r\n\r\n\t\twindow.addEventListener('resize', () => {\r\n\t\t\tthis.width = window.innerWidth;\r\n\t\t\tthis.height = window.innerHeight;\r\n\t\t\tthis.maxX = map.columns * map.tileSize - this.width;\r\n\t\t\tthis.maxY = map.rows * map.tileSize - this.height;\r\n\t\t});\r\n\t}\r\n\r\n\tfollow(player) {\r\n\t\tthis.following = player;\r\n\t}\r\n\r\n\tupdate() {\r\n\t\t// assume followed sprite should be placed at the center of the screen\r\n\t\t// whenever possible\r\n\t\tthis.following.screenX = (this.width / 2) - (this.following.sprite.width / 2);\r\n\t\tthis.following.screenY = (this.height / 2) - (this.following.sprite.height / 2);\r\n\r\n\t\t// make the camera follow the sprite\r\n\t\tthis.x = this.following.x - this.following.screenX;\r\n\t\tthis.y = this.following.y - this.following.screenY;\r\n\t\t// clamp values\r\n\t\tthis.x = Math.max(0, Math.min(this.x, this.maxX));\r\n\t\tthis.y = Math.max(0, Math.min(this.y, this.maxY));\r\n\r\n\t\t// in map corners, the sprite cannot be placed in the center of the screen\r\n\t\t// and we have to change its screen coordinates\r\n\r\n\t\t// left and right sides\r\n\t\tif (this.following.x < this.following.screenX ||\r\n\t\t\tthis.following.x > this.maxX + this.following.screenX) {\r\n\t\t\tthis.following.screenX = this.following.x - this.x;\r\n\t\t}\r\n\t\t// top and bottom sides\r\n\t\tif (this.following.y < this.following.screenY ||\r\n\t\t\tthis.following.y > this.maxY + this.following.screenY) {\r\n\t\t\tthis.following.screenY = this.following.y - this.y;\r\n\t\t}\r\n\t}\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/modules/camera.js","import { Character } from './character';\r\nimport { Sprite } from './sprite';\r\nimport { STATES as STATE } from './constants/states';\r\nimport { Weapon } from './weapon';\r\nimport { INVERTORY } from './constants/invertory';\r\n\r\nexport class Player extends Character {\r\n\tconstructor(world, config) {\r\n\t\tsuper(world.width / 2, world.height / 2, world, config);\r\n\t\tthis.defaultSprite = this.sprite;\r\n\t\tthis.activeSprite = new Sprite(config.srcActive, config.width, config.height, config.animationSpeed); // lightning unicorn\r\n\t\tthis.screenX = this.x;\r\n\t\tthis.screenY = this.y;\r\n\r\n\t\tthis.invertory = {\r\n\t\t\tpistol: new Weapon(INVERTORY.pistol)\r\n\t\t};\r\n\t\tthis.currentItem = this.invertory.pistol;\r\n\t}\r\n\r\n\t_updateState(x, y) {\r\n\t\tthis.sprite = this.currentItem ? this.activeSprite : this.defaultSprite;\r\n\t\tthis.direction = this.mousex > this.screenX + (this.sprite.width / 2) ? 1 : -1;\r\n\r\n\t\tif (this.currentItem) {\r\n\t\t\tthis.currentItem.sprite = this.direction > 0 ? this.currentItem.spriteForward : this.currentItem.spriteBackward;\r\n\t\t}\r\n\r\n\t\tif (x || y) {\r\n\t\t\tthis.state = this.direction === 1 ? STATE.moveForward : STATE.moveBackward;\r\n\t\t\tif (x * this.direction * this.sprite.speed < 0) {\r\n\t\t\t\tthis.sprite.speed = -this.sprite.speed;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (!x && !y) {\r\n\t\t\tthis.state = this.direction === 1 ? STATE.idleForward : STATE.idleBackward;\r\n\t\t}\r\n\t}\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/modules/player.js","export class Mouse {\r\n\tconstructor() {\r\n\t\tthis.x = 0;\r\n\t\tthis.y = 0;\r\n\t\twindow.addEventListener('mousemove', event => {\r\n\t\t\tthis.x = event.clientX;\r\n\t\t\tthis.y = event.clientY;\r\n\t\t});\r\n\t\twindow.addEventListener('mousedown', () => {\r\n\t\t\tthis.isClicked = true;\r\n\t\t});\r\n\t\twindow.addEventListener('mouseup', () => {\r\n\t\t\tthis.isClicked = false;\r\n\t\t});\r\n\t\twindow.addEventListener('blur', () => {\r\n\t\t\tthis.isClicked = false;\r\n\t\t});\r\n\t}\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/modules/mouse.js","import { Character } from './character';\r\n\r\nexport class Enemy extends Character {\r\n\tconstructor(world, player, config) {\r\n\t\tsuper(Math.random() * world.width - config.width, Math.random() * world.height - config.height, world, config);\r\n\t\tthis.name = config.name;\r\n\t\tthis.player = player;\r\n\t\tthis.damage = config.damage;\r\n\t\tthis.attackSpeed = config.attackSpeed;\r\n\t\tthis.award = config.award;\r\n\t}\r\n\r\n\tattackPlayer(delta) {\r\n\t\tif (Math.sqrt(Math.pow(Math.abs(this.x - this.player.x), 2) + Math.pow(Math.abs(this.y - this.player.y), 2)) > 60) {\r\n\t\t\tlet x = 0, y = 0;\r\n\r\n\t\t\tif (this.x > this.player.x) {\r\n\t\t\t\tx = -1\r\n\t\t\t}\r\n\t\t\telse if (this.x < this.player.x) {\r\n\t\t\t\tx = 1\r\n\t\t\t}\r\n\r\n\t\t\tif (this.y > this.player.y) {\r\n\t\t\t\ty = -1\r\n\t\t\t}\r\n\t\t\telse if (this.y < this.player.y) {\r\n\t\t\t\ty = 1\r\n\t\t\t}\r\n\r\n\t\t\tsuper.move(delta, x, y);\r\n\t\t} else {\r\n\t\t\t// attack\r\n\t\t\tif (!this.isAttacking) {\r\n\t\t\t\tthis.player.health -= this.damage;\r\n\t\t\t\tconsole.log('Player health - ' + this.player.health);\r\n\t\t\t\tthis.isAttacking = true;\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tthis.isAttacking = false;\r\n\t\t\t\t}, this.attackSpeed);\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\r\n\t_dealDamage() {\r\n\r\n\t}\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/modules/enemy.js","export const KEYS = {\r\n\tup: 87,\r\n\tdown: 83,\r\n\tleft: 65,\r\n\tright: 68,\r\n\tpistol: 49,\r\n\tshotgun: 50,\r\n\tassaultRifle: 51,\r\n\treload: 82,\r\n\tpause: 27\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/modules/constants/keys.js","export const RESOURCES = {\r\n\timages: [\r\n\t\t'img/main.png',\r\n\t\t'img/pause.png',\r\n\t\t'img/gameOver.png',\r\n\t\t'img/map.png',\r\n\t\t'img/player.png',\r\n\t\t'img/playerActive.png',\r\n\t\t'img/aim.png',\r\n\t\t'img/weapon.png',\r\n\t\t'img/hole.png',\r\n\t\t'img/fire.png',\r\n\t\t'img/blood.png',\r\n\t\t'img/rat.png',\r\n\t],\r\n\tsounds: [\r\n\t\t'sound/background.mp3',\r\n\t\t'sound/trot.mp3',\r\n\t\t'sound/pickup.mp3',\r\n\t\t'sound/empty.mp3',\r\n\t\t'sound/pistol.mp3',\r\n\t\t'sound/pistolReload.mp3',\r\n\t\t'sound/shotgun.mp3',\r\n\t\t'sound/shotgunReload.mp3',\r\n\t\t'sound/assaultRifle.mp3',\r\n\t\t'sound/assaultRifleReload.mp3',\r\n\t\t'sound/ratAttack.mp3',\r\n\t\t'sound/ratDeath.mp3',\r\n\t]\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/modules/constants/resources.js","export const CHARACTERS = {\r\n\tplayer: {\r\n\t\t// movementSpeed, x, y, src, srcActive, width, height, animationSpeed\r\n\t\tsrc: 'img/player.png',\r\n\t\tsrcActive: 'img/playerActive.png',\r\n\t\twidth: 106,\r\n\t\theight: 96,\r\n\t\tanimationSpeed: 16,\r\n\t\tmovementSpeed: 155,\r\n\t\thealth: 100\r\n\t},\r\n\trat: {\r\n\t\tname: 'rat',\r\n\t\tsrc: 'img/rat.png',\r\n\t\twidth: 96.25,\r\n\t\theight: 46,\r\n\t\tanimationSpeed: 14,\r\n\t\tmovementSpeed: 100,\r\n\t\thealth: 50,\r\n\t\tdamage: 5,\r\n\t\tattackSpeed: 2000,\r\n\t\taward: 100\r\n\t}\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/modules/constants/characters.js","export const SPRITES = {\r\n\thole: {\r\n\t\tsrc: 'img/hole.png',\r\n\t\twidth: 10,\r\n\t\theight: 10\r\n\t},\r\n\tblood: {\r\n\t\tsrc: 'img/blood.png',\r\n\t\twidth: 50,\r\n\t\theight: 50\r\n\t}\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/modules/constants/sprites.js"],"sourceRoot":""}